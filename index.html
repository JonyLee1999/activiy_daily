<html lang="zh-CN"><head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>O2Oå¹³å°å››è±¡é™å¯¹æ¯”çœ‹æ¿ï¼ˆæ— åå­—ç®­å¤´ï¼‰</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
  
  <!-- Chart.jsåŠ è½½è„šæœ¬ -->
  <script>
    // Chart.jsåŠ è½½çŠ¶æ€
    window.chartJsLoaded = false;
    window.chartJsLoadPromise = null;
    
    // æ£€æŸ¥Chart.jsæ˜¯å¦å·²åŠ è½½
    function checkChartJS() {
      return typeof Chart !== 'undefined' && Chart.version;
    }
    
    // å°è¯•åŠ è½½Chart.jsçš„å¤šä¸ªCDNæº
    function loadChartJS() {
      if (window.chartJsLoadPromise) {
        return window.chartJsLoadPromise;
      }
      
      console.log('å¼€å§‹åŠ è½½Chart.js');
      
      window.chartJsLoadPromise = new Promise((resolve, reject) => {
        // å°è¯•åŠ è½½ç¬¬ä¸€ä¸ªCDNæº
        tryLoadChartJS('https://cdn.bootcdn.net/ajax/libs/Chart.js/3.9.1/chart.min.js', resolve, reject);
      });
      
      return window.chartJsLoadPromise;
    }
    
    // å°è¯•ä»æŒ‡å®šURLåŠ è½½Chart.js
    function tryLoadChartJS(url, resolve, reject, retryCount = 0) {
      console.log(`å°è¯•ä» ${url} åŠ è½½Chart.js`);
      
      const script = document.createElement('script');
      script.src = url;
      
      script.onload = function() {
        if (checkChartJS()) {
          window.chartJsLoaded = true;
          console.log('Chart.jsåŠ è½½æˆåŠŸï¼Œç‰ˆæœ¬:', Chart.version);
          resolve();
        } else {
          // å¦‚æœåŠ è½½æˆåŠŸä½†Chartå¯¹è±¡ä¸å¯ç”¨ï¼Œå°è¯•ä¸‹ä¸€ä¸ªCDN
          tryNextCDN(resolve, reject, retryCount);
        }
      };
      
      script.onerror = function() {
        console.log(`ä» ${url} åŠ è½½Chart.jså¤±è´¥`);
        // åŠ è½½å¤±è´¥ï¼Œå°è¯•ä¸‹ä¸€ä¸ªCDN
        tryNextCDN(resolve, reject, retryCount);
      };
      
      document.head.appendChild(script);
    }
    
    // å°è¯•ä¸‹ä¸€ä¸ªCDN
    function tryNextCDN(resolve, reject, retryCount) {
      const cdnUrls = [
        'https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js',
        'https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js',
        'https://unpkg.com/chart.js@3.9.1/dist/chart.min.js'
      ];
      
      if (retryCount < cdnUrls.length) {
        tryLoadChartJS(cdnUrls[retryCount], resolve, reject, retryCount + 1);
      } else {
        const error = new Error('æ‰€æœ‰Chart.jsåŠ è½½æºéƒ½å¤±è´¥');
        console.error(error);
        reject(error);
      }
    }
    
    // ç­‰å¾…Chart.jsåŠ è½½å®Œæˆ
    function waitForChartJS() {
      return new Promise((resolve, reject) => {
        if (checkChartJS()) {
          resolve();
          return;
        }
        
        // å°è¯•åŠ è½½Chart.js
        loadChartJS().then(resolve).catch(reject);
      });
    }
    
    // é¡µé¢åŠ è½½å®Œæˆåè‡ªåŠ¨åŠ è½½Chart.js
    document.addEventListener('DOMContentLoaded', function() {
      loadChartJS().catch(error => {
        console.error('Chart.jsåŠ è½½å¤±è´¥:', error);
        updateStatus('Chart.jsåŠ è½½å¤±è´¥', 'âŒ');
      });
    });
  </script>
  <script>
    // çŠ¶æ€æ›´æ–°å‡½æ•°
    function updateStatus(message, icon) {
      const statusElement = document.getElementById('status');
      if (statusElement) {
        statusElement.innerHTML = `${icon} ${message}`;
      }
    }
  </script>
  
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            'meituan': '#FFD161',
             'eleme': '#0086FF',
             'jd': '#01af00',
            'hvle': '#FFF8E6',  // é«˜é‡ä½æ•ˆèƒŒæ™¯
            'hvle-text': '#D48806', // é«˜é‡ä½æ•ˆæ–‡å­—
            'hq': '#E6F7F0',    // ä¼˜è´¨åŒé«˜èƒŒæ™¯
            'hq-text': '#007A4D', // ä¼˜è´¨åŒé«˜æ–‡å­—
            'ltl': '#FFEEEE',   // é•¿å°¾åŒä½èƒŒæ™¯
            'ltl-text': '#C53030', // é•¿å°¾åŒä½æ–‡å­—
            'hele': '#F7F0E9',  // é«˜æ•ˆä½é‡èƒŒæ™¯
            'hele-text': '#A05F2C', // é«˜æ•ˆä½é‡æ–‡å­—
          },
        },
      }
    }
  </script>
  
  <style type="text/tailwindcss">
    @layer utilities {
      .platform-column {
        @apply flex-1 p-3 border-r last:border-r-0 border-gray-100;
      }
      .platform-header {
        @apply text-center font-bold py-1.5 rounded mb-2 text-white;
      }
      .metric-item {
        @apply py-1.5 border-b border-gray-100 flex justify-between items-center;
      }
      .quadrant-card {
        @apply rounded-2xl shadow-lg hover:shadow-xl overflow-hidden transition-all duration-300 border border-gray-100;
      }
      .clickable {
        @apply cursor-pointer hover:bg-gray-50 transition-colors;
      }
      .axis-line {
        @apply absolute bg-gray-400 z-10;
      }
      .axis-label {
        @apply absolute font-medium text-gray-600 z-20 whitespace-nowrap;
      }
      /* åˆ»åº¦æ ·å¼ */
      .axis-tick {
        @apply absolute bg-gray-400 z-10;
      }
      .x-tick {
        @apply h-2 w-0.5;
      }
      .y-tick {
        @apply w-2 h-0.5;
      }
      .tick-label {
        @apply absolute text-xs text-gray-500 z-20 whitespace-nowrap;
      }
      .axis-title {
        @apply font-semibold text-gray-700;
      }
      /* åˆ¸æ˜ç»†æ ·å¼ */
      .coupon-detail-row {
        @apply border-b border-gray-100 py-3 last:border-0;
      }
      .coupon-detail-label {
        @apply text-xs text-gray-500 mt-1;
      }
      /* å¹³å°Tabæ ·å¼ - å¢å¼ºæ•ˆæœ */
      .platform-tab {
        @apply text-gray-600 hover:text-gray-800 shadow-md hover:shadow-lg;
      }
      .platform-tab.active {
        @apply bg-white text-blue-600 shadow-lg border border-blue-200;
      }
      
      /* æ·»åŠ é¢å¤–çš„æ ·å¼å¢å¼º */
      .metric-card {
        @apply bg-white rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 border border-gray-100 transform hover:-translate-y-1;
      }
      
      .progress-container {
        @apply relative drop-shadow-lg;
      }
      
      .chart-enhanced {
        @apply bg-gradient-to-br from-white to-gray-50 rounded-xl border border-gray-200 shadow-inner;
      }
      
      /* æ•°æ®æ˜¾ç¤ºå¢å¼º */
      .data-value {
        @apply text-2xl font-bold bg-gradient-to-r from-gray-800 to-gray-600 bg-clip-text text-transparent;
      }
      
      .trend-positive {
        @apply text-green-600 bg-green-50 px-2 py-1 rounded-md text-xs font-medium;
      }
      
      .trend-negative {
        @apply text-red-600 bg-red-50 px-2 py-1 rounded-md text-xs font-medium;
      }
    }
  </style>
</head>

<body class="bg-gray-50 p-4 md:p-6">
  <div class="max-w-6xl mx-auto">
    <h1 class="text-2xl md:text-3xl font-bold text-gray-800 mb-2">O2Oå¹³å°ä¸šåŠ¡å¯¹æ¯”çœ‹æ¿</h1>
    <p class="text-gray-500 mb-4">å››è±¡é™åˆ†æï¼ˆROI vs æ´»åŠ¨GMVå æ¯”ï¼‰</p>
    
    <!-- æ—¥æœŸèŒƒå›´ç­›é€‰å™¨ -->
    <div class="bg-white rounded-xl shadow-lg border border-gray-100 mb-6 p-4">
      <div class="flex flex-col sm:flex-row items-start sm:items-center gap-4">
        <div class="flex items-center gap-2">
          <i class="fa fa-calendar text-blue-600"></i>
          <span class="text-sm font-medium text-gray-700">æ•°æ®æ—¶é—´èŒƒå›´ï¼š</span>
        </div>
        <div class="flex flex-col sm:flex-row items-start sm:items-center gap-3">
          <div class="flex items-center gap-2">
            <label class="text-sm text-gray-600">å¼€å§‹æ—¥æœŸï¼š</label>
            <input type="date" id="startDate" class="px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500" />
          </div>
          <div class="flex items-center gap-2">
            <label class="text-sm text-gray-600">ç»“æŸæ—¥æœŸï¼š</label>
            <input type="date" id="endDate" class="px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500" />
          </div>
          <button id="applyDateFilter" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors flex items-center gap-2">
            <i class="fa fa-filter"></i>
            åº”ç”¨ç­›é€‰
          </button>
          <button id="resetDateFilter" class="bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors flex items-center gap-2">
            <i class="fa fa-refresh"></i>
            é‡ç½®
          </button>
        </div>
      </div>
      <div class="mt-3 text-xs text-gray-500">
        <span id="dateRangeDisplay">å½“å‰é€‰æ‹©ï¼š</span>
      </div>
    </div>
    
    <!-- å›¾è¡¨çŠ¶æ€æŒ‡ç¤ºå™¨ -->
    <div id="chartStatus" class="mb-4 p-3 rounded-lg bg-yellow-100 border border-yellow-300">
      <div class="flex items-center">
        <div id="statusIcon" class="mr-2">â³</div>
        <div id="statusText">æ­£åœ¨åŠ è½½å›¾è¡¨...</div>
      </div>
    </div>

    <!-- å¹³å°Tabå¯¼èˆª - å¢å¼ºæ ·å¼ -->
    <div class="flex space-x-2 mb-8 bg-gradient-to-r from-gray-100 to-gray-200 p-2 rounded-xl w-fit shadow-lg border border-gray-200">
      <button id="tab-all" class="platform-tab active px-6 py-3 rounded-lg text-sm font-semibold transition-all duration-300 transform hover:scale-105" onclick="switchPlatform('all')">å…¨å¹³å°</button>
      <button id="tab-meituan" class="platform-tab px-6 py-3 rounded-lg text-sm font-semibold transition-all duration-300 transform hover:scale-105" onclick="switchPlatform('meituan')">ç¾å›¢</button>
      <button id="tab-eleme" class="platform-tab px-6 py-3 rounded-lg text-sm font-semibold transition-all duration-300 transform hover:scale-105" onclick="switchPlatform('eleme')">é¥¿äº†ä¹ˆ</button>
      <button id="tab-jd" class="platform-tab px-6 py-3 rounded-lg text-sm font-semibold transition-all duration-300 transform hover:scale-105" onclick="switchPlatform('jd')">äº¬ä¸œåˆ°å®¶</button>
    </div>

    <!-- æ–°å¢æŒ‡æ ‡å¡åŒºåŸŸ -->
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 mb-6">
      <!-- é¢„ç®—é‡‘é¢æŒ‡æ ‡å¡ -->
      <div class="bg-white p-4 rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 border border-gray-100">
        <h3 class="text-sm text-gray-500 font-medium mb-2">é¢„ç®—é‡‘é¢</h3>
        <p class="text-2xl font-bold my-4">50,000</p>
        <div class="flex flex-col space-y-1 mt-1">
          <span class="text-xs text-green-500"><i class="fa fa-arrow-up"></i> å¹´åŒæ¯” +8.5%</span>
          <span class="text-xs text-green-500"><i class="fa fa-arrow-up"></i> æœˆç¯æ¯” +5.2%</span>
        </div>
      </div>

      <!-- æ ¸é”€é‡‘é¢æŒ‡æ ‡å¡ -->
      <div class="bg-white p-4 rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 border border-gray-100">
        <h3 class="text-sm text-gray-500 font-medium mb-2">æ ¸é”€é‡‘é¢</h3>
        <p class="text-2xl font-bold my-4">32,150</p>
        <div class="flex flex-col space-y-1 mt-1">
          <span class="text-xs text-green-500"><i class="fa fa-arrow-up"></i> å¹´åŒæ¯” +15.8%</span>
          <span class="text-xs text-red-500"><i class="fa fa-arrow-down"></i> æœˆç¯æ¯” -1.3%</span>
        </div>
      </div>

      <!-- é¢„ç®—è¿›åº¦æŒ‡æ ‡å¡ -->
      <div class="bg-white p-4 rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 border border-gray-100">
        <h3 class="text-sm text-gray-500 font-medium mb-2">é¢„ç®—è¿›åº¦</h3>
        <div class="flex justify-center items-center my-4">
          <div class="relative w-32 h-16 drop-shadow-sm">
            <!-- å¤–å±‚é¢„ç®—è¿›åº¦åŠåœ† - å¢å¤§å°ºå¯¸ -->
            <svg class="w-full h-full filter drop-shadow-sm" viewBox="0 0 100 50">
              <!-- èƒŒæ™¯è½¨é“ -->
              <defs>
                <linearGradient id="bgGradient" x1="0%" y1="0%" x2="100%" y2="0%">
                  <stop offset="0%" style="stop-color:#f3f4f6;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#e5e7eb;stop-opacity:1" />
                </linearGradient>
                <linearGradient id="budgetGradient" x1="0%" y1="0%" x2="100%" y2="0%">
                  <stop offset="0%" style="stop-color:#fbbf24;stop-opacity:1" />
                  <stop offset="50%" style="stop-color:#f59e0b;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#d97706;stop-opacity:1" />
                </linearGradient>
              </defs>
              <path d="M 5 50 A 45 45 0 0 1 95 50" fill="none" stroke="url(#bgGradient)" stroke-width="9" stroke-linecap="round"/>
              <path d="M 5 50 A 45 45 0 0 1 95 50" fill="none" stroke="url(#budgetGradient)" stroke-width="9" stroke-linecap="round" stroke-dasharray="141.5" stroke-dashoffset="42.45" id="consumption-progress" class="drop-shadow-sm" />
            </svg>
            <!-- å†…å±‚æ—¶é—´è¿›åº¦åŠåœ† - å¢å¤§å°ºå¯¸ -->
            <svg class="absolute inset-0 w-full h-full filter drop-shadow-sm" viewBox="0 0 100 50">
              <defs>
                <linearGradient id="timeGradient" x1="0%" y1="0%" x2="100%" y2="0%">
                  <stop offset="0%" style="stop-color:#60a5fa;stop-opacity:1" />
                  <stop offset="50%" style="stop-color:#3b82f6;stop-opacity:1" />
                  <stop offset="100%" style="stop-color:#2563eb;stop-opacity:1" />
                </linearGradient>
              </defs>
              <path d="M 15 50 A 35 35 0 0 1 85 50" fill="none" stroke="url(#bgGradient)" stroke-width="7" stroke-linecap="round"/>
              <path d="M 15 50 A 35 35 0 0 1 85 50" fill="none" stroke="url(#timeGradient)" stroke-width="7" stroke-linecap="round" stroke-dasharray="110" stroke-dashoffset="38.5" class="drop-shadow-sm" />
            </svg>
            <!-- ä¸­é—´æ–‡å­— - è°ƒæ•´ä½ç½®é¿å…é‡å ä½†ä¿æŒå åŠ æ ·å¼ -->
            <div class="absolute inset-0 flex flex-col items-center justify-center pt-10">
              <span class="text-xl font-bold text-gray-800 drop-shadow-sm">70%</span>
              <span class="text-xs text-gray-500 mt-1">æ—¶é—´è¿›åº¦: 60%</span>
            </div>
          </div>
        </div>
      </div>

      <!-- æ´»åŠ¨GMVæŒ‡æ ‡å¡ -->
      <div class="bg-white p-4 rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 border border-gray-100">
        <h3 class="text-sm text-gray-500 font-medium mb-2">æ´»åŠ¨GMV</h3>
        <p class="text-2xl font-bold my-4">78,900</p>
        <div class="flex flex-col space-y-1 mt-1">
          <span class="text-xs text-green-500"><i class="fa fa-arrow-up"></i> å¹´åŒæ¯” +8.7%</span>
          <span class="text-xs text-green-500"><i class="fa fa-arrow-up"></i> æœˆç¯æ¯” +2.1%</span>
        </div>
      </div>

      <!-- æ´»åŠ¨è´¹æ¯”æŒ‡æ ‡å¡ -->
      <div class="bg-white p-4 rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 border border-gray-100">
        <h3 class="text-sm text-gray-500 font-medium mb-2">æ´»åŠ¨è´¹æ¯”</h3>
        <p class="text-2xl font-bold my-4">18.5%</p>
        <div class="flex flex-col space-y-1 mt-1">
          <span class="text-xs text-red-500"><i class="fa fa-arrow-up"></i> å¹´åŒæ¯” +2.3pp</span>
          <span class="text-xs text-green-500"><i class="fa fa-arrow-down"></i> æœˆç¯æ¯” -0.8pp</span>
        </div>
      </div>

      <!-- æ´»åŠ¨ROIæŒ‡æ ‡å¡ -->
      <div class="bg-white p-4 rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 border border-gray-100">
        <h3 class="text-sm text-gray-500 font-medium mb-2">æ´»åŠ¨ROI</h3>
        <p class="text-2xl font-bold my-4">3.2</p>
        <div class="flex flex-col space-y-1 mt-1">
          <span class="text-xs text-green-500"><i class="fa fa-arrow-up"></i> å¹´åŒæ¯” +0.6</span>
          <span class="text-xs text-red-500"><i class="fa fa-arrow-down"></i> æœˆç¯æ¯” -0.3</span>
        </div>
      </div>

      <!-- GMVæŒ‡æ ‡å¡ -->
      <div class="bg-white p-4 rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 border border-gray-100">
        <h3 class="text-sm text-gray-500 font-medium mb-2">GMV</h3>
        <p class="text-2xl font-bold my-4">123,456</p>
        <div class="flex flex-col space-y-1 mt-1">
          <span class="text-xs text-green-500"><i class="fa fa-arrow-up"></i> å¹´åŒæ¯” +12.3%</span>
          <span class="text-xs text-red-500"><i class="fa fa-arrow-down"></i> æœˆç¯æ¯” -4.5%</span>
        </div>
      </div>

      <!-- å…¨é‡è´¹æ¯”æŒ‡æ ‡å¡ -->
      <div class="bg-white p-4 rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 border border-gray-100">
        <h3 class="text-sm text-gray-500 font-medium mb-2">å…¨é‡è´¹æ¯”</h3>
        <p class="text-2xl font-bold my-4">12.3%</p>
        <div class="flex flex-col space-y-1 mt-1">
          <span class="text-xs text-red-500"><i class="fa fa-arrow-up"></i> å¹´åŒæ¯” +1.5pp</span>
          <span class="text-xs text-red-500"><i class="fa fa-arrow-up"></i> æœˆç¯æ¯” +0.4pp</span>
        </div>
      </div>

      <!-- RIOæŒ‡æ ‡å¡ -->
      <div class="bg-white p-4 rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 border border-gray-100">
        <h3 class="text-sm text-gray-500 font-medium mb-2">RIO</h3>
        <p class="text-2xl font-bold my-4">2.8</p>
        <div class="flex flex-col space-y-1 mt-1">
          <span class="text-xs text-green-500"><i class="fa fa-arrow-up"></i> å¹´åŒæ¯” +0.4</span>
          <span class="text-xs text-green-500"><i class="fa fa-arrow-up"></i> æœˆç¯æ¯” +0.2</span>
        </div>
      </div>
    </div>

    <!-- æ ¸é”€è´¹ç”¨è¶‹åŠ¿å›¾ - åªåœ¨å…¨å¹³å°æ˜¾ç¤º -->
    <div id="expenseChartContainer" class="bg-white rounded-xl shadow-lg border border-gray-100 mb-8 overflow-hidden">
      <div class="bg-gradient-to-r from-green-50 to-emerald-50 px-6 py-4 border-b border-gray-100">
        <h3 class="text-xl font-bold text-gray-800 flex items-center">
          <i class="fa fa-line-chart mr-3 text-green-600"></i>
          å„å¹³å°æ ¸é”€è´¹ç”¨è¶‹åŠ¿åˆ†æ
        </h3>
        <p class="text-sm text-gray-600 mt-1">å®æ—¶ç›‘æ§å„å¹³å°æ ¸é”€è´¹ç”¨å˜åŒ–æƒ…å†µ</p>
      </div>
      <div class="p-6">
        <div class="chart-container h-80 relative bg-gradient-to-br from-gray-50 to-white rounded-xl border border-gray-100 p-4 shadow-inner">
          <canvas id="expenseChart" class="rounded-lg"></canvas>
        </div>
      </div>
    </div>

    <!-- å¹³å°æ•°æ®å›¾è¡¨å®¹å™¨ - ä¼˜åŒ–å¸ƒå±€ -->
    <div id="platformChartContainer" class="bg-white rounded-xl shadow-lg border border-gray-100 mb-8 hidden overflow-hidden">
      <div class="bg-gradient-to-r from-blue-50 to-indigo-50 px-6 py-4 border-b border-gray-100">
        <h3 class="text-xl font-bold text-gray-800 flex items-center">
          <i class="fa fa-line-chart mr-3 text-blue-600"></i>
          å¹³å°æ•°æ®è¶‹åŠ¿åˆ†æ
        </h3>
        <p class="text-sm text-gray-600 mt-1">å®æ—¶ç›‘æ§å„å¹³å°æ ¸é”€é‡‘é¢ä¸è´¹æ¯”å˜åŒ–</p>
      </div>
      <div class="p-6">
        <div class="chart-container h-96 relative bg-gradient-to-br from-gray-50 to-white rounded-xl border border-gray-100 p-4 shadow-inner">
          <canvas id="platformChart" class="rounded-lg"></canvas>
        </div>
      </div>
    </div>

    <!-- å¹³å°æ•°æ®è¡¨æ ¼å®¹å™¨ - åªåœ¨å•å¹³å°æ˜¾ç¤º -->
    <div id="platformTablesContainer" class="space-y-8 mb-8 hidden">
      <!-- ç¬¬ä¸€ä¸ªè¡¨æ ¼ï¼šæ´»åŠ¨æ–¹æ¡ˆæ•°æ® -->
      <div class="bg-white rounded-xl shadow-lg border border-gray-100 overflow-hidden">
        <div class="bg-gradient-to-r from-purple-50 to-indigo-50 px-6 py-4 border-b border-gray-100">
          <h3 class="text-xl font-bold text-gray-800 flex items-center">
            <i class="fa fa-list-alt mr-3 text-purple-600"></i>
            æ´»åŠ¨æ–¹æ¡ˆæ•°æ®è¡¨
          </h3>
          <p class="text-sm text-gray-600 mt-1">æ´»åŠ¨æ–¹æ¡ˆè¯¦æƒ…åŠé¢„ç®—æ‰§è¡Œæƒ…å†µ</p>
        </div>
        <div class="overflow-x-auto">
          <table id="activityPlanTable" class="w-full">
            <thead class="bg-gray-50">
              <tr>
                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">æ´»åŠ¨ç±»å‹</th>
                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">æ–¹æ¡ˆåç§°</th>
                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">æ´»åŠ¨åç§°</th>
                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">æœºåˆ¶åç§°</th>
                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">æœºåˆ¶ç±»å‹</th>
                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">åˆ¸åŠ›åº¦</th>
                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">åˆ¸é—¨æ§›</th>
                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">åˆ¸é¢é¢</th>
                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">æ´»åŠ¨æ—¶é—´</th>
                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">é¢„ç®—é‡‘é¢</th>
                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">MTDæ ¸é”€é‡‘é¢</th>
                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">MTDæ ¸é”€è¿›åº¦</th>
                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">MTDæ—¶é—´è¿›åº¦</th>
                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">é¢„ç®—ä½™é¢</th>
              </tr>
            </thead>
            <tbody id="activityPlanTableBody" class="bg-white divide-y divide-gray-200">
              <!-- æ•°æ®å°†é€šè¿‡JavaScriptåŠ¨æ€å¡«å…… -->
            </tbody>
          </table>
        </div>
      </div>

      <!-- ç¬¬äºŒä¸ªè¡¨æ ¼ï¼šæ´»åŠ¨æ•ˆæœæ•°æ® -->
      <div class="bg-white rounded-xl shadow-lg border border-gray-100 overflow-hidden">
        <div class="bg-gradient-to-r from-green-50 to-emerald-50 px-6 py-4 border-b border-gray-100">
          <h3 class="text-xl font-bold text-gray-800 flex items-center">
            <i class="fa fa-table mr-3 text-green-600"></i>
            æ´»åŠ¨æ•ˆæœæ•°æ®è¡¨
          </h3>
          <p class="text-sm text-gray-600 mt-1">å„æ–¹æ¡ˆæ´»åŠ¨æ•ˆæœåŠæ ¸é”€æƒ…å†µç»Ÿè®¡</p>
        </div>
        <div class="overflow-x-auto">
          <table id="activityEffectTable" class="w-full">
            <thead class="bg-gray-50">
              <tr>
                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">æ–¹æ¡ˆåç§°</th>
                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">æ´»åŠ¨ç±»å‹</th>
                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">æœºåˆ¶ç±»å‹</th>
                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">æœºåˆ¶</th>
                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">æŠ˜æ‰£åŠ›åº¦</th>
                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">åˆ¸é—¨æ§›</th>
                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">åˆ¸é¢é¢</th>
                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">å½“æ—¥æ ¸é”€é‡‘é¢</th>
                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">å½“æ—¥æ´»åŠ¨GMV</th>
                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">æ´»åŠ¨è´¹æ¯”</th>
                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">MTDæ ¸é”€é‡‘é¢</th>
                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">MTDæ´»åŠ¨GMV</th>
                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">MTDæ´»åŠ¨è´¹æ¯”</th>
              </tr>
            </thead>
            <tbody id="activityEffectTableBody" class="bg-white divide-y divide-gray-200">
              <!-- æ•°æ®å°†é€šè¿‡JavaScriptåŠ¨æ€å¡«å…… -->
            </tbody>
          </table>
        </div>
      </div>
    </div>


    <!-- å››è±¡é™å®¹å™¨ - å·²åˆ é™¤åå­—ç®­å¤´ -->
    <div id="quadrant-container" class="relative">      
      <!-- åæ ‡è½´æ ‡ç­¾ï¼ˆä¿ç•™æ ‡ç­¾ï¼Œåˆ é™¤åå­—çº¿ï¼‰ -->
      <div class="hidden md:block axis-label bottom-0 left-1/2 transform translate-x-[-40%] -translate-y-full mb-2">
        <i class="fa fa-long-arrow-right mr-1"></i> 
      </div>
      <div class="hidden md:block axis-label top-1/2 right-0 transform -translate-y-1/2 translate-x-full ml-2 writing-mode:vertical-rl">
        <span class="axis-title"></span>
        <i class="fa fa-long-arrow-up ml-1"></i>
      </div>
      
      <!-- å››è±¡é™å¸ƒå±€ -->
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6 relative z-20">
        <!-- ç¬¬ä¸€è¡Œç¬¬ä¸€åˆ—ï¼šé«˜é‡ä½æ•ˆ -->
        <div class="quadrant-card">
          <div class="bg-hvle p-4 border-b border-gray-100">
            <h2 class="text-xl font-bold text-hvle-text">é«˜é‡ä½æ•ˆ</h2>
            <p class="text-gray-600 mt-1 text-sm"><span class="font-medium">è¯´æ˜ï¼š</span>ROI&lt;å‡å€¼ï¼ŒGMVå æ¯”å¤§</p>
          </div>
          <div class="flex flex-col md:flex-row">
            <!-- ç¾å›¢åˆ— -->
            <div class="platform-column">
              <div class="platform-header bg-meituan">ç¾å›¢</div>
              <div class="space-y-1">
                <div class="metric-item">
                  <span class="text-gray-600 text-sm"><i class="fa fa-line-chart mr-1"></i> ROI</span>
                  <span class="font-medium">3.9</span>
                </div>
                <div class="metric-item">
                  <span class="text-gray-600 text-sm"><i class="fa fa-shopping-cart mr-1"></i> GMVå æ¯”</span>
                  <span class="font-medium">53.9%</span>
                </div>
                <div class="metric-item">
                  <span class="text-gray-600 text-sm"><i class="fa fa-percent mr-1"></i> TSå æ¯”</span>
                  <span class="font-medium">63.0%</span>
                </div>
                <div class="metric-item clickable" onclick="showCouponDetail('ç¾å›¢-é«˜é‡ä½æ•ˆåˆ¸æ•°æ˜ç»†', [
                       {name: 'æ»¡200å‡50', owner: 'å¹³å°è¡¥è´´', type: 'é€šç”¨åˆ¸'},
                       {name: 'æ»¡100å‡20', owner: 'å“ç‰Œè”åˆ', type: 'å“ç±»åˆ¸'},
                       {name: 'æ–°ç”¨æˆ·ä¸“äº«åˆ¸', owner: 'å¹³å°è¡¥è´´', type: 'æ–°äººåˆ¸'}
                     ])">
                  <span class="text-gray-600 text-sm"><i class="fa fa-ticket mr-1"></i> åˆ¸æ•°</span>
                  <span class="font-medium text-blue-600">9 <i class="fa fa-angle-right ml-1 text-xs"></i></span>
                </div>
              </div>
            </div>
            
            <!-- é¥¿äº†ä¹ˆåˆ— -->
            <div class="platform-column">
              <div class="platform-header bg-eleme">é¥¿äº†ä¹ˆ</div>
              <div class="space-y-1">
                <div class="metric-item">
                  <span class="text-gray-600 text-sm"><i class="fa fa-line-chart mr-1"></i> ROI</span>
                  <span class="font-medium">4.4</span>
                </div>
                <div class="metric-item">
                  <span class="text-gray-600 text-sm"><i class="fa fa-shopping-cart mr-1"></i> GMVå æ¯”</span>
                  <span class="font-medium">47.0%</span>
                </div>
                <div class="metric-item">
                  <span class="text-gray-600 text-sm"><i class="fa fa-percent mr-1"></i> TSå æ¯”</span>
                  <span class="font-medium">52.6%</span>
                </div>
                <div class="metric-item clickable" onclick="showCouponDetail('é¥¿äº†ä¹ˆ-é«˜é‡ä½æ•ˆåˆ¸æ•°æ˜ç»†', [
                       {name: 'æ»¡150å‡30', owner: 'å¹³å°è¡¥è´´', type: 'é€šç”¨åˆ¸'},
                       {name: 'å“ç±»åˆ¸', owner: 'å•†å®¶æ‰¿æ‹…', type: 'å“ç±»åˆ¸'},
                       {name: 'å‘¨æœ«åˆ¸', owner: 'å¹³å°+å•†å®¶', type: 'æ—¶æ®µåˆ¸'}
                     ])">
                  <span class="text-gray-600 text-sm"><i class="fa fa-ticket mr-1"></i> åˆ¸æ•°</span>
                  <span class="font-medium text-blue-600">13 <i class="fa fa-angle-right ml-1 text-xs"></i></span>
                </div>
              </div>
            </div>
            
            <!-- äº¬ä¸œåˆ°å®¶åˆ— -->
            <div class="platform-column">
              <div class="platform-header bg-jd">äº¬ä¸œåˆ°å®¶</div>
              <div class="space-y-1">
                <div class="metric-item">
                  <span class="text-gray-600 text-sm"><i class="fa fa-line-chart mr-1"></i> ROI</span>
                  <span class="font-medium">3.2</span>
                </div>
                <div class="metric-item">
                  <span class="text-gray-600 text-sm"><i class="fa fa-shopping-cart mr-1"></i> GMVå æ¯”</span>
                  <span class="font-medium">41.5%</span>
                </div>
                <div class="metric-item">
                  <span class="text-gray-600 text-sm"><i class="fa fa-percent mr-1"></i> TSå æ¯”</span>
                  <span class="font-medium">58.3%</span>
                </div>
                <div class="metric-item clickable" onclick="showCouponDetail('äº¬ä¸œåˆ°å®¶-é«˜é‡ä½æ•ˆåˆ¸æ•°æ˜ç»†', [
                       {name: 'æ–°ç”¨æˆ·åˆ¸', owner: 'å¹³å°è¡¥è´´', type: 'æ–°äººåˆ¸'},
                       {name: 'æ»¡99å‡15', owner: 'å¹³å°è¡¥è´´', type: 'é€šç”¨åˆ¸'},
                       {name: 'å“ç±»ä¸“äº«', owner: 'å•†å®¶æ‰¿æ‹…', type: 'å“ç±»åˆ¸'}
                     ])">
                  <span class="text-gray-600 text-sm"><i class="fa fa-ticket mr-1"></i> åˆ¸æ•°</span>
                  <span class="font-medium text-blue-600">11 <i class="fa fa-angle-right ml-1 text-xs"></i></span>
                </div>
              </div>
            </div>
          </div>
          <div class="p-3 bg-gray-50 text-sm text-gray-600 border-t border-gray-100">
            ç­–ç•¥å»ºè®®ï¼šä¼˜åŒ–åˆ¸æ•ˆï¼Œé™ä½æ— æ•ˆå‘åˆ¸ï¼Œè°ƒæ•´ä½¿ç”¨é—¨æ§›
          </div>
        </div>
        
        <!-- ç¬¬ä¸€è¡Œç¬¬äºŒåˆ—ï¼šä¼˜è´¨åŒé«˜ -->
         <div class="quadrant-card">
           <div class="bg-hq p-4 border-b border-gray-100">
             <h2 class="text-xl font-bold text-hq-text">ä¼˜è´¨åŒé«˜</h2>
             <p class="text-gray-600 mt-1 text-sm"><span class="font-medium">è¯´æ˜ï¼š</span>ROI&gt;å‡å€¼ï¼ŒGMVå æ¯”å¤§</p>
          </div>
          <div class="flex flex-col md:flex-row">
            <!-- ç¾å›¢åˆ— -->
            <div class="platform-column">
              <div class="platform-header bg-meituan">ç¾å›¢</div>
              <div class="space-y-1">
                <div class="metric-item">
                  <span class="text-gray-600 text-sm"><i class="fa fa-line-chart mr-1"></i> ROI</span>
                  <span class="font-medium">5.9</span>
                </div>
                <div class="metric-item">
                  <span class="text-gray-600 text-sm"><i class="fa fa-shopping-cart mr-1"></i> GMVå æ¯”</span>
                  <span class="font-medium">37.9%</span>
                </div>
                <div class="metric-item">
                  <span class="text-gray-600 text-sm"><i class="fa fa-percent mr-1"></i> TSå æ¯”</span>
                  <span class="font-medium">28.6%</span>
                </div>
                <div class="metric-item clickable" onclick="showCouponDetail('ç¾å›¢-ä¼˜è´¨åŒé«˜åˆ¸æ•°æ˜ç»†', [
                       {name: 'æ»¡300å‡100', owner: 'å¹³å°+å•†å®¶', type: 'é€šç”¨åˆ¸'},
                       {name: 'å“ç±»ä¸“äº«åˆ¸', owner: 'å•†å®¶æ‰¿æ‹…', type: 'å“ç±»åˆ¸'},
                       {name: 'ä¼šå‘˜æ—¥ç‰¹æƒ ', owner: 'å¹³å°è¡¥è´´', type: 'ä¼šå‘˜åˆ¸'}
                     ])">
                  <span class="text-gray-600 text-sm"><i class="fa fa-ticket mr-1"></i> åˆ¸æ•°</span>
                  <span class="font-medium text-blue-600">12 <i class="fa fa-angle-right ml-1 text-xs"></i></span>
                </div>
              </div>
            </div>
            
            <!-- é¥¿äº†ä¹ˆåˆ— -->
            <div class="platform-column">
              <div class="platform-header bg-eleme">é¥¿äº†ä¹ˆ</div>
              <div class="space-y-1">
                <div class="metric-item">
                  <span class="text-gray-600 text-sm"><i class="fa fa-line-chart mr-1"></i> ROI</span>
                  <span class="font-medium">6.0</span>
                </div>
                <div class="metric-item">
                  <span class="text-gray-600 text-sm"><i class="fa fa-shopping-cart mr-1"></i> GMVå æ¯”</span>
                  <span class="font-medium">42.3%</span>
                </div>
                <div class="metric-item">
                  <span class="text-gray-600 text-sm"><i class="fa fa-percent mr-1"></i> TSå æ¯”</span>
                  <span class="font-medium">34.8%</span>
                </div>
                <div class="metric-item clickable" onclick="showCouponDetail('é¥¿äº†ä¹ˆ-ä¼˜è´¨åŒé«˜åˆ¸æ•°æ˜ç»†', [
                       {name: 'æ»¡200å‡80', owner: 'å¹³å°+å•†å®¶', type: 'é€šç”¨åˆ¸'},
                       {name: 'å‘¨æœ«ç‰¹æƒ åˆ¸', owner: 'å¹³å°è¡¥è´´', type: 'æ—¶æ®µåˆ¸'},
                       {name: 'çˆ†æ¬¾ä¸“äº«', owner: 'å•†å®¶æ‰¿æ‹…', type: 'å•†å“åˆ¸'}
                     ])">
                  <span class="text-gray-600 text-sm"><i class="fa fa-ticket mr-1"></i> åˆ¸æ•°</span>
                  <span class="font-medium text-blue-600">15 <i class="fa fa-angle-right ml-1 text-xs"></i></span>
                </div>
              </div>
            </div>
            
            <!-- äº¬ä¸œåˆ°å®¶åˆ— -->
            <div class="platform-column">
              <div class="platform-header bg-jd">äº¬ä¸œåˆ°å®¶</div>
              <div class="space-y-1">
                <div class="metric-item">
                  <span class="text-gray-600 text-sm"><i class="fa fa-line-chart mr-1"></i> ROI</span>
                  <span class="font-medium">5.2</span>
                </div>
                <div class="metric-item">
                  <span class="text-gray-600 text-sm"><i class="fa fa-shopping-cart mr-1"></i> GMVå æ¯”</span>
                  <span class="font-medium">35.7%</span>
                </div>
                <div class="metric-item">
                  <span class="text-gray-600 text-sm"><i class="fa fa-percent mr-1"></i> TSå æ¯”</span>
                  <span class="font-medium">31.2%</span>
                </div>
                <div class="metric-item clickable" onclick="showCouponDetail('äº¬ä¸œåˆ°å®¶-ä¼˜è´¨åŒé«˜åˆ¸æ•°æ˜ç»†', [
                       {name: 'æ»¡150å‡50', owner: 'å¹³å°+å•†å®¶', type: 'é€šç”¨åˆ¸'},
                       {name: 'ä¼šå‘˜åˆ¸', owner: 'å¹³å°è¡¥è´´', type: 'ä¼šå‘˜åˆ¸'},
                       {name: 'é™æ—¶æŠ˜æ‰£', owner: 'å•†å®¶æ‰¿æ‹…', type: 'æ—¶æ®µåˆ¸'}
                     ])">
                  <span class="text-gray-600 text-sm"><i class="fa fa-ticket mr-1"></i> åˆ¸æ•°</span>
                  <span class="font-medium text-blue-600">10 <i class="fa fa-angle-right ml-1 text-xs"></i></span>
                </div>
              </div>
            </div>
          </div>
          <div class="p-3 bg-gray-50 text-sm text-gray-600 border-t border-gray-100">
            ç­–ç•¥å»ºè®®ï¼šæ‰©å¤§è¦†ç›–èŒƒå›´ï¼Œå¢åŠ é¢„ç®—æŠ•å…¥ï¼Œå¤åˆ¶æˆåŠŸæ¨¡å¼
          </div>
        </div>
        
        <!-- ç¬¬äºŒè¡Œç¬¬ä¸€åˆ—ï¼šé•¿å°¾åŒä½ -->
         <div class="quadrant-card">
           <div class="bg-ltl p-4 border-b border-gray-100">
             <h2 class="text-xl font-bold text-ltl-text">é•¿å°¾åŒä½</h2>
             <p class="text-gray-600 mt-1 text-sm"><span class="font-medium">è¯´æ˜ï¼š</span>ROI&lt;å‡å€¼ï¼ŒGMVå æ¯”å°</p>
          </div>
          <div class="flex flex-col md:flex-row">
            <!-- ç¾å›¢åˆ— -->
            <div class="platform-column">
              <div class="platform-header bg-meituan">ç¾å›¢</div>
              <div class="space-y-1">
                <div class="metric-item">
                  <span class="text-gray-600 text-sm"><i class="fa fa-line-chart mr-1"></i> ROI</span>
                  <span class="font-medium">3.7</span>
                </div>
                <div class="metric-item">
                  <span class="text-gray-600 text-sm"><i class="fa fa-shopping-cart mr-1"></i> GMVå æ¯”</span>
                  <span class="font-medium">4.2%</span>
                </div>
                <div class="metric-item">
                  <span class="text-gray-600 text-sm"><i class="fa fa-percent mr-1"></i> TSå æ¯”</span>
                  <span class="font-medium">5.6%</span>
                </div>
                <div class="metric-item clickable" onclick="showCouponDetail('ç¾å›¢-é•¿å°¾åŒä½åˆ¸æ•°æ˜ç»†', [
                       {name: 'æ»¡50å‡5', owner: 'å•†å®¶æ‰¿æ‹…', type: 'é€šç”¨åˆ¸'},
                       {name: 'æŒ‡å®šå•†å“åˆ¸', owner: 'å•†å®¶æ‰¿æ‹…', type: 'å•†å“åˆ¸'},
                       {name: 'ä¸´æœŸç‰¹æƒ åˆ¸', owner: 'å•†å®¶æ‰¿æ‹…', type: 'æ—¶æ®µåˆ¸'}
                     ])">
                  <span class="text-gray-600 text-sm"><i class="fa fa-ticket mr-1"></i> åˆ¸æ•°</span>
                  <span class="font-medium text-blue-600">30 <i class="fa fa-angle-right ml-1 text-xs"></i></span>
                </div>
              </div>
            </div>
            
            <!-- é¥¿äº†ä¹ˆåˆ— -->
            <div class="platform-column">
              <div class="platform-header bg-eleme">é¥¿äº†ä¹ˆ</div>
              <div class="space-y-1">
                <div class="metric-item">
                  <span class="text-gray-600 text-sm"><i class="fa fa-line-chart mr-1"></i> ROI</span>
                  <span class="font-medium">3.7</span>
                </div>
                <div class="metric-item">
                  <span class="text-gray-600 text-sm"><i class="fa fa-shopping-cart mr-1"></i> GMVå æ¯”</span>
                  <span class="font-medium">6.6%</span>
                </div>
                <div class="metric-item">
                  <span class="text-gray-600 text-sm"><i class="fa fa-percent mr-1"></i> TSå æ¯”</span>
                  <span class="font-medium">9.4%</span>
                </div>
                <div class="metric-item clickable" onclick="showCouponDetail('é¥¿äº†ä¹ˆ-é•¿å°¾åŒä½åˆ¸æ•°æ˜ç»†', [
                       {name: 'å°é¢é€šç”¨åˆ¸', owner: 'å•†å®¶æ‰¿æ‹…', type: 'é€šç”¨åˆ¸'},
                       {name: 'ä¸´æœŸç‰¹æƒ åˆ¸', owner: 'å•†å®¶æ‰¿æ‹…', type: 'æ—¶æ®µåˆ¸'},
                       {name: 'ç‰¹å®šå•†å“', owner: 'å•†å®¶æ‰¿æ‹…', type: 'å•†å“åˆ¸'}
                     ])">
                  <span class="text-gray-600 text-sm"><i class="fa fa-ticket mr-1"></i> åˆ¸æ•°</span>
                  <span class="font-medium text-blue-600">47 <i class="fa fa-angle-right ml-1 text-xs"></i></span>
                </div>
              </div>
            </div>
            
            <!-- äº¬ä¸œåˆ°å®¶åˆ— -->
            <div class="platform-column">
              <div class="platform-header bg-jd">äº¬ä¸œåˆ°å®¶</div>
              <div class="space-y-1">
                <div class="metric-item">
                  <span class="text-gray-600 text-sm"><i class="fa fa-line-chart mr-1"></i> ROI</span>
                  <span class="font-medium">3.0</span>
                </div>
                <div class="metric-item">
                  <span class="text-gray-600 text-sm"><i class="fa fa-shopping-cart mr-1"></i> GMVå æ¯”</span>
                  <span class="font-medium">5.8%</span>
                </div>
                <div class="metric-item">
                  <span class="text-gray-600 text-sm"><i class="fa fa-percent mr-1"></i> TSå æ¯”</span>
                  <span class="font-medium">7.2%</span>
                </div>
                <div class="metric-item clickable" onclick="showCouponDetail('äº¬ä¸œåˆ°å®¶-é•¿å°¾åŒä½åˆ¸æ•°æ˜ç»†', [
                       {name: 'æ»¡60å‡6', owner: 'å•†å®¶æ‰¿æ‹…', type: 'é€šç”¨åˆ¸'},
                       {name: 'ç‰¹å®šå“ç±»åˆ¸', owner: 'å•†å®¶æ‰¿æ‹…', type: 'å“ç±»åˆ¸'},
                       {name: 'æ¸…ä»“åˆ¸', owner: 'å•†å®¶æ‰¿æ‹…', type: 'å•†å“åˆ¸'}
                     ])">
                  <span class="text-gray-600 text-sm"><i class="fa fa-ticket mr-1"></i> åˆ¸æ•°</span>
                  <span class="font-medium text-blue-600">35 <i class="fa fa-angle-right ml-1 text-xs"></i></span>
                </div>
              </div>
            </div>
          </div>
          <div class="p-3 bg-gray-50 text-sm text-gray-600 border-t border-gray-100">
            ç­–ç•¥å»ºè®®ï¼šåœæ­¢å‘åˆ¸ï¼Œåˆå¹¶åˆ¸æ± ï¼Œè¯„ä¼°æ˜¯å¦ä¸‹æ¶è¯¥ç±»æ´»åŠ¨
          </div>
        </div>
        
        <!-- ç¬¬äºŒè¡Œç¬¬äºŒåˆ—ï¼šé«˜æ•ˆä½é‡ -->
        <div class="quadrant-card">
          <div class="bg-hele p-4 border-b border-gray-100">
            <h2 class="text-xl font-bold text-hele-text">é«˜æ•ˆä½é‡</h2>
            <p class="text-gray-600 mt-1 text-sm"><span class="font-medium">è¯´æ˜ï¼š</span>ROI&gt;å‡å€¼ï¼ŒGMVå æ¯”å°</p>
          </div>
          <div class="flex flex-col md:flex-row">
            <!-- ç¾å›¢åˆ— -->
            <div class="platform-column">
              <div class="platform-header bg-meituan">ç¾å›¢</div>
              <div class="space-y-1">
                <div class="metric-item">
                  <span class="text-gray-600 text-sm"><i class="fa fa-line-chart mr-1"></i> ROI</span>
                  <span class="font-medium">6.9</span>
                </div>
                <div class="metric-item">
                  <span class="text-gray-600 text-sm"><i class="fa fa-shopping-cart mr-1"></i> GMVå æ¯”</span>
                  <span class="font-medium">3.9%</span>
                </div>
                <div class="metric-item">
                  <span class="text-gray-600 text-sm"><i class="fa fa-percent mr-1"></i> TSå æ¯”</span>
                  <span class="font-medium">2.8%</span>
                </div>
                <div class="metric-item clickable" onclick="showCouponDetail('ç¾å›¢-é«˜æ•ˆä½é‡åˆ¸æ•°æ˜ç»†', [
                       {name: 'æ»¡500å‡200', owner: 'å¹³å°+å•†å®¶', type: 'é«˜ç«¯åˆ¸'},
                       {name: 'ä¼šå‘˜ä¸“äº«åˆ¸', owner: 'å¹³å°è¡¥è´´', type: 'ä¼šå‘˜åˆ¸'},
                       {name: 'é«˜ç«¯ç”¨æˆ·åˆ¸', owner: 'å¹³å°è¡¥è´´', type: 'å®šå‘åˆ¸'}
                     ])">
                  <span class="text-gray-600 text-sm"><i class="fa fa-ticket mr-1"></i> åˆ¸æ•°</span>
                  <span class="font-medium text-blue-600">42 <i class="fa fa-angle-right ml-1 text-xs"></i></span>
                </div>
              </div>
            </div>
            
            <!-- é¥¿äº†ä¹ˆåˆ— -->
            <div class="platform-column">
              <div class="platform-header bg-eleme">é¥¿äº†ä¹ˆ</div>
              <div class="space-y-1">
                <div class="metric-item">
                  <span class="text-gray-600 text-sm"><i class="fa fa-line-chart mr-1"></i> ROI</span>
                  <span class="font-medium">6.8</span>
                </div>
                <div class="metric-item">
                  <span class="text-gray-600 text-sm"><i class="fa fa-shopping-cart mr-1"></i> GMVå æ¯”</span>
                  <span class="font-medium">4.1%</span>
                </div>
                <div class="metric-item">
                  <span class="text-gray-600 text-sm"><i class="fa fa-percent mr-1"></i> TSå æ¯”</span>
                  <span class="font-medium">3.2%</span>
                </div>
                <div class="metric-item clickable" onclick="showCouponDetail('é¥¿äº†ä¹ˆ-é«˜æ•ˆä½é‡åˆ¸æ•°æ˜ç»†', [
                       {name: 'æ»¡400å‡150', owner: 'å¹³å°+å•†å®¶', type: 'é«˜ç«¯åˆ¸'},
                       {name: 'é«˜ç«¯ç”¨æˆ·åˆ¸', owner: 'å¹³å°è¡¥è´´', type: 'å®šå‘åˆ¸'},
                       {name: 'ç²¾å“ä¸“äº«', owner: 'å•†å®¶æ‰¿æ‹…', type: 'å•†å“åˆ¸'}
                     ])">
                  <span class="text-gray-600 text-sm"><i class="fa fa-ticket mr-1"></i> åˆ¸æ•°</span>
                  <span class="font-medium text-blue-600">37 <i class="fa fa-angle-right ml-1 text-xs"></i></span>
                </div>
              </div>
            </div>
            
            <!-- äº¬ä¸œåˆ°å®¶åˆ— -->
            <div class="platform-column">
              <div class="platform-header bg-jd">äº¬ä¸œåˆ°å®¶</div>
              <div class="space-y-1">
                <div class="metric-item">
                  <span class="text-gray-600 text-sm"><i class="fa fa-line-chart mr-1"></i> ROI</span>
                  <span class="font-medium">5.7</span>
                </div>
                <div class="metric-item">
                  <span class="text-gray-600 text-sm"><i class="fa fa-shopping-cart mr-1"></i> GMVå æ¯”</span>
                  <span class="font-medium">3.5%</span>
                </div>
                <div class="metric-item">
                  <span class="text-gray-600 text-sm"><i class="fa fa-percent mr-1"></i> TSå æ¯”</span>
                  <span class="font-medium">2.5%</span>
                </div>
                <div class="metric-item clickable" onclick="showCouponDetail('äº¬ä¸œåˆ°å®¶-é«˜æ•ˆä½é‡åˆ¸æ•°æ˜ç»†', [
                       {name: 'æ»¡300å‡100', owner: 'å¹³å°+å•†å®¶', type: 'é«˜ç«¯åˆ¸'},
                       {name: 'ç²¾å“ä¸“äº«åˆ¸', owner: 'å•†å®¶æ‰¿æ‹…', type: 'å•†å“åˆ¸'},
                       {name: 'é«˜ç«¯ä¼šå‘˜', owner: 'å¹³å°è¡¥è´´', type: 'ä¼šå‘˜åˆ¸'}
                     ])">
                  <span class="text-gray-600 text-sm"><i class="fa fa-ticket mr-1"></i> åˆ¸æ•°</span>
                  <span class="font-medium text-blue-600">28 <i class="fa fa-angle-right ml-1 text-xs"></i></span>
                </div>
              </div>
            </div>
          </div>
          <div class="p-3 bg-gray-50 text-sm text-gray-600 border-t border-gray-100">ç­–ç•¥å»ºè®®ï¼šæ‰©å¤§æ›å…‰ï¼Œå¢åŠ ç”¨æˆ·è¦†ç›–ï¼Œæå‡æ´»åŠ¨è§„æ¨¡</div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- åˆ¸æ•°æ˜ç»†å¼¹çª— -->
  <div id="couponDetailModal" class="fixed inset-0 bg-black/50 flex items-center justify-center z-50 hidden">
    <div class="bg-white rounded-xl max-w-md w-full max-h-[80vh] overflow-auto m-4 shadow-xl">
      <div class="p-5 border-b border-gray-100 flex justify-between items-center">
        <h3 id="modalTitle" class="text-lg font-bold text-gray-800">åˆ¸æ•°æ˜ç»†</h3>
        <button onclick="hideCouponDetail()" class="text-gray-400 hover:text-gray-600">
          <i class="fa fa-times text-xl"></i>
        </button>
      </div>
      
      <div class="p-5">
        <!-- è¡¨å¤´ -->
        <div class="grid grid-cols-4 gap-2 font-medium text-sm text-gray-500 mb-3 pb-2 border-b">
          <div class="col-span-1">åºå·</div>
          <div class="col-span-1">åˆ¸åç§°</div>
          <div class="col-span-1">æ´»åŠ¨å½’å±</div>
          <div class="col-span-1">åˆ¸ç±»å‹</div>
        </div>
        
        <!-- åˆ¸æ˜ç»†å†…å®¹ -->
        <div id="couponList" class="space-y-1">
          <!-- å†…å®¹å°†é€šè¿‡JSåŠ¨æ€å¡«å…… -->
        </div>
      </div>
      
      <div class="p-4 border-t border-gray-100 flex justify-end">
        <button onclick="hideCouponDetail()" class="px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-md text-gray-700 transition-colors">
          å…³é—­
        </button>
      </div>
    </div>
  </div>

  <script>
    // å¹³å°åˆ‡æ¢åŠŸèƒ½
    function switchPlatform(platform) {
      // æ›´æ–°Tabæ ·å¼
      document.querySelectorAll('.platform-tab').forEach(tab => {
        tab.classList.remove('active');
      });
      document.getElementById(`tab-${platform}`).classList.add('active');
      
      // æ§åˆ¶å››è±¡é™å’Œå›¾è¡¨æ˜¾ç¤º
      const quadrantContainer = document.getElementById('quadrant-container');
      const chartContainer = document.getElementById('platformChartContainer');
      const expenseContainer = document.getElementById('expenseChartContainer');
      const tablesContainer = document.getElementById('platformTablesContainer');
      
      if (platform === 'all') {
        quadrantContainer.style.display = 'block';
        chartContainer.classList.add('hidden');
        expenseContainer.classList.remove('hidden');
        tablesContainer.classList.add('hidden'); // éšè—è¡¨æ ¼
        setTimeout(() => {
          renderExpenseChart();
        }, 100);
      } else {
        quadrantContainer.style.display = 'none';
        chartContainer.classList.remove('hidden');
        expenseContainer.classList.add('hidden');
        tablesContainer.classList.remove('hidden'); // æ˜¾ç¤ºè¡¨æ ¼
        setTimeout(() => {
          renderPlatformChart(platform);
          loadPlatformTableData(platform); // åŠ è½½è¡¨æ ¼æ•°æ®
        }, 100);
      }
    }
    
    // æ¸²æŸ“å…¨å¹³å°æ ¸é”€è´¹ç”¨è¶‹åŠ¿å›¾
    function renderExpenseChart() {
      console.log('å¼€å§‹æ¸²æŸ“å…¨å¹³å°æ ¸é”€è´¹ç”¨è¶‹åŠ¿å›¾');
      updateStatus('æ¸²æŸ“å…¨å¹³å°å›¾è¡¨...', 'ğŸ¯');
      
      // æ£€æŸ¥Chart.jsæ˜¯å¦å¯ç”¨
      if (!checkChartJS()) {
        console.error('Chart.jsä¸å¯ç”¨ï¼Œæ— æ³•æ¸²æŸ“å›¾è¡¨');
        updateStatus('Chart.jsä¸å¯ç”¨', 'âŒ');
        return;
      }
      
      const canvas = document.getElementById('expenseChart');
      if (!canvas) {
        console.error('æ‰¾ä¸åˆ°expenseChartå…ƒç´ ');
        updateStatus('æ‰¾ä¸åˆ°å›¾è¡¨å®¹å™¨', 'âŒ');
        return;
      }
      
      console.log('Canvaså…ƒç´ å·²æ‰¾åˆ°ï¼Œå°ºå¯¸:', canvas.width, 'x', canvas.height);
      
      // ç®€åŒ–çš„æ¨¡æ‹Ÿæ•°æ®
      const dates = ['12-01', '12-02', '12-03', '12-04', '12-05'];
      const data = {
        meituan: [125000, 135000, 145000, 155000, 165000],
        eleme: [98000, 108000, 118000, 128000, 138000],
        jd: [78000, 85000, 92000, 99000, 108000]
      };
      
      // é”€æ¯å·²æœ‰å›¾è¡¨
      if (window.expenseChartInstance) {
        window.expenseChartInstance.destroy();
        window.expenseChartInstance = null;
      }
      
      try {
        const ctx = canvas.getContext('2d');
        if (!ctx) {
          console.error('æ— æ³•è·å–Canvas 2Dä¸Šä¸‹æ–‡');
          return;
        }
        
        window.expenseChartInstance = new Chart(ctx, {
          type: 'line',
          data: {
            labels: dates,
            datasets: [
              {
                label: 'ç¾å›¢',
                data: data.meituan,
                borderColor: '#FFD161',
                backgroundColor: '#FFD16120',
                borderWidth: 3,
                fill: true
              },
              {
                label: 'é¥¿äº†ä¹ˆ',
                data: data.eleme,
                borderColor: '#0086FF',
                backgroundColor: '#0086FF20',
                borderWidth: 3,
                fill: true
              },
              {
                label: 'äº¬ä¸œåˆ°å®¶',
                data: data.jd,
                borderColor: '#01af00',
                backgroundColor: '#01af0020',
                borderWidth: 3,
                fill: true
              }
            ]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
              title: {
                display: true,
                text: 'å„å¹³å°æ ¸é”€è´¹ç”¨è¶‹åŠ¿å¯¹æ¯”',
                font: { size: 16, weight: 'bold' }
              },
              legend: {
                position: 'bottom'
              }
            },
            scales: {
              y: {
                beginAtZero: true,
                title: { display: true, text: 'æ ¸é”€è´¹ç”¨' }
              }
            }
          }
        });
        
        console.log('å…¨å¹³å°å›¾è¡¨åˆ›å»ºæˆåŠŸï¼');
        updateStatus('å…¨å¹³å°å›¾è¡¨åˆ›å»ºæˆåŠŸï¼', 'âœ…');
      } catch (error) {
        console.error('å›¾è¡¨åˆ›å»ºå¤±è´¥:', error);
        updateStatus('å›¾è¡¨åˆ›å»ºå¤±è´¥: ' + error.message, 'âŒ');
      }
    }
    
    // æ¸²æŸ“å•å¹³å°æ•°æ®å›¾è¡¨
    function renderPlatformChart(platform) {
      console.log(`å¼€å§‹æ¸²æŸ“å¹³å°å›¾è¡¨: ${platform}`);
      updateStatus(`æ¸²æŸ“${platform}å›¾è¡¨...`, 'ğŸ¯');
      
      if (!checkChartJS()) {
        console.error('Chart.jsä¸å¯ç”¨');
        updateStatus('Chart.jsä¸å¯ç”¨', 'âŒ');
        return;
      }
      
      const canvas = document.getElementById('platformChart');
      if (!canvas) {
        console.error('æ‰¾ä¸åˆ°platformChartå…ƒç´ ');
        updateStatus('æ‰¾ä¸åˆ°å¹³å°å›¾è¡¨å®¹å™¨', 'âŒ');
        return;
      }
      
      const dates = ['12-01', '12-02', '12-03', '12-04', '12-05'];
      let chartData, platformName;
      
      switch(platform) {
        case 'meituan':
          platformName = 'ç¾å›¢';
          chartData = {
            amounts: [890000, 950000, 1020000, 1150000, 1180000],
            feeRatio: [12.5, 12.8, 13.2, 14.0, 14.3]
          };
          break;
        case 'eleme':
          platformName = 'é¥¿äº†ä¹ˆ';
          chartData = {
            amounts: [650000, 680000, 720000, 820000, 840000],
            feeRatio: [11.8, 12.1, 12.5, 13.4, 13.7]
          };
          break;
        case 'jd':
          platformName = 'äº¬ä¸œåˆ°å®¶';
          chartData = {
            amounts: [480000, 510000, 540000, 610000, 620000],
            feeRatio: [13.2, 13.5, 13.9, 14.8, 15.1]
          };
          break;
        default:
          return;
      }
      
      // é”€æ¯å·²æœ‰å›¾è¡¨
      if (window.platformChartInstance) {
        window.platformChartInstance.destroy();
        window.platformChartInstance = null;
      }
      
      try {
        const ctx = canvas.getContext('2d');
        window.platformChartInstance = new Chart(ctx, {
          type: 'bar',
          data: {
            labels: dates,
            datasets: [
              {
                label: 'æ ¸é”€é‡‘é¢',
                data: chartData.amounts,
                backgroundColor: '#2196F3',
                yAxisID: 'y'
              },
              {
                label: 'è´¹æ¯”%',
                data: chartData.feeRatio,
                type: 'line',
                borderColor: '#4CAF50',
                backgroundColor: 'transparent',
                borderWidth: 3,
                yAxisID: 'y1'
              }
            ]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
              title: {
                display: true,
                text: platformName + 'æ•°æ®è¶‹åŠ¿åˆ†æ',
                font: { size: 16, weight: 'bold' }
              },
              legend: { position: 'bottom' }
            },
            scales: {
              y: {
                type: 'linear',
                position: 'left',
                title: { display: true, text: 'æ ¸é”€é‡‘é¢' },
                beginAtZero: true
              },
              y1: {
                type: 'linear',
                position: 'right',
                title: { display: true, text: 'è´¹æ¯”(%)' },
                grid: { drawOnChartArea: false },
                min: 0,
                max: 20
              }
            }
          }
        });
        
        console.log(`${platformName}å›¾è¡¨åˆ›å»ºæˆåŠŸï¼`);
        updateStatus(`${platformName}å›¾è¡¨åˆ›å»ºæˆåŠŸï¼`, 'âœ…');
      } catch (error) {
        console.error(`åˆ›å»º${platformName}å›¾è¡¨å¤±è´¥:`, error);
        updateStatus(`åˆ›å»ºå›¾è¡¨å¤±è´¥: ${error.message}`, 'âŒ');
      }
    }

    // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
    document.addEventListener('DOMContentLoaded', function() {
      console.log('DOMåŠ è½½å®Œæˆï¼Œå¼€å§‹åˆå§‹åŒ–');
      updateStatus('é¡µé¢åŠ è½½å®Œæˆ...', 'â³');
      
      // åˆå§‹åŒ–æ—¥æœŸç­›é€‰å™¨
      initializeDateFilter();
      
      // ç­‰å¾…Chart.jsåŠ è½½å®Œæˆ
      waitForChartJS().then(() => {
        console.log('Chart.jså·²å°±ç»ªï¼Œç‰ˆæœ¬:', Chart.version);
        updateStatus('Chart.jsåŠ è½½æˆåŠŸ...', 'âœ…');
        setTimeout(initializeCharts, 300);
      }).catch((error) => {
        console.error('Chart.jsåŠ è½½å¤±è´¥:', error);
        updateStatus('Chart.jsåŠ è½½å¤±è´¥ï¼Œè¯·åˆ·æ–°é¡µé¢', 'âŒ');
      });
    });
    
    function initializeCharts() {
      updateStatus('æ£€æŸ¥Chart.jsåº“...', 'â³');
      
      if (!checkChartJS()) {
        console.error('Chart.jsä»ç„¶ä¸å¯ç”¨');
        updateStatus('Chart.jsåŠ è½½å¤±è´¥ï¼Œè¯·åˆ·æ–°é¡µé¢', 'âŒ');
        return;
      }
      
      updateStatus('Chart.jsåŠ è½½æˆåŠŸï¼Œæ£€æŸ¥å…ƒç´ ...', 'âœ…');
      console.log('Chart.jsç‰ˆæœ¬:', Chart.version);
      
      const expenseCanvas = document.getElementById('expenseChart');
      const platformCanvas = document.getElementById('platformChart');
      
      if (!expenseCanvas || !platformCanvas) {
        console.error('æ‰¾ä¸åˆ°å›¾è¡¨å®¹å™¨å…ƒç´ ');
        updateStatus('æ‰¾ä¸åˆ°å›¾è¡¨å®¹å™¨å…ƒç´ ', 'âŒ');
        return;
      }
      
      updateStatus('å¼€å§‹æ¸²æŸ“å›¾è¡¨...', 'â³');
      
      // æ¸²æŸ“å›¾è¡¨
      renderExpenseChart();
      switchPlatform('all');
      
      updateStatus('å›¾è¡¨åˆå§‹åŒ–å®Œæˆï¼', 'âœ…');
      
      // 5ç§’åéšè—çŠ¶æ€æ¡
      setTimeout(() => {
        const statusDiv = document.getElementById('chartStatus');
        if (statusDiv) {
          statusDiv.style.display = 'none';
        }
      }, 5000);
    }

    // æ˜¾ç¤ºåˆ¸æ•°æ˜ç»†
    function showCouponDetail(title, coupons) {
      document.getElementById('modalTitle').textContent = title;
      const couponList = document.getElementById('couponList');
      couponList.innerHTML = '';
      
      coupons.forEach((coupon, index) => {
        const item = document.createElement('div');
        item.className = 'grid grid-cols-4 gap-2 items-center p-2 hover:bg-gray-50 rounded coupon-detail-row';
        item.innerHTML = `
          <div class="col-span-1 font-medium">${index + 1}</div>
          <div class="col-span-1">${coupon.name}</div>
          <div class="col-span-1">${coupon.owner}</div>
          <div class="col-span-1">${coupon.type}</div>
        `;
        couponList.appendChild(item);
      });
      
      document.getElementById('couponDetailModal').classList.remove('hidden');
      document.body.style.overflow = 'hidden';
    }
    
    function hideCouponDetail() {
      document.getElementById('couponDetailModal').classList.add('hidden');
      document.body.style.overflow = '';
    }
    
    // è°ƒè¯•ä¿¡æ¯ç®¡ç†
    function toggleDebug() {
      const debugInfo = document.getElementById('debugInfo');
      if (debugInfo.style.display === 'none') {
        debugInfo.style.display = 'block';
      } else {
        debugInfo.style.display = 'none';
      }
    }
  </script>
  
  <script>
    // è®¡ç®—æ—¶é—´è¿›åº¦ (å½“æœˆT-1)
    function calculateTimeProgress() {
      const now = new Date();
      const currentMonth = now.getMonth();
      const currentYear = now.getFullYear();
      const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();
      const dayOfMonth = Math.min(now.getDate() - 1, daysInMonth); // T-1
      return (dayOfMonth / daysInMonth) * 100;
    }

    document.addEventListener('DOMContentLoaded', function() {
      // è®¡ç®—è¿›åº¦å¯¹åº”çš„åœ†ç¯
      const setProgress = (elementId, progress, radius, gapDegree = 0) => {
        const circle = document.getElementById(elementId);
        // è®¡ç®—å®é™…æ˜¾ç¤ºçš„ç™¾åˆ†æ¯”ï¼ˆè€ƒè™‘ç¼ºå£)
        const effectiveProgress = gapDegree > 0 ? progress * (1 - gapDegree / (Math.PI * radius * (365/180))) : progress;
        // åŠåœ†å‘¨é•¿
        const circumference = Math.PI * radius;
        // è®¡ç®—ç¼ºå£å¯¹åº”çš„åƒç´ å€¼
        const gapPixels = gapDegree > 0 ? (gapDegree / (Math.PI * radius * (365/189))) * Math.PI * radius : 0;
        // è®¾ç½®åœ†ç¯å±æ€§
        circle.style.strokeDasharray = `${circumference} ${gapPixels}`;
        circle.style.strokeDashoffset = circumference - (effectiveProgress / 100) * circumference;
        
        // æ›´æ–°è¿›åº¦æ–‡æœ¬
        if (elementId === 'consumption-progress') {
          const textElement = circle.parentElement.querySelector('text');
          if (textElement) {
            textElement.textContent = `${Math.round(progress)}%`;
          }
        }
      };
    
      // è®¾ç½®æ¶ˆè€—è¿›åº¦ä¸º75%ï¼Œæ— ç¼ºå£
      setProgress('consumption-progress', 75, 40);
    });
    
    // æ¸²æŸ“å¹³å°æ•°æ®å›¾è¡¨ - å‚è€ƒGMVè¶‹åŠ¿åˆ†ææ ·å¼
function renderPlatformChart(platform) {
  console.log(`å¼€å§‹æ¸²æŸ“å¹³å°å›¾è¡¨: ${platform}`);
  updateStatus(`æ¸²æŸ“${platform}å›¾è¡¨...`, 'ğŸ¯');
  
  // æ£€æŸ¥Chart.jsæ˜¯å¦å¯ç”¨ï¼Œå¦‚æœä¸å¯ç”¨åˆ™ç­‰å¾…åŠ è½½
  if (!checkChartJS()) {
    console.log('Chart.jså°šæœªåŠ è½½ï¼Œç­‰å¾…åŠ è½½å®Œæˆ...');
    updateStatus('ç­‰å¾…Chart.jsåŠ è½½...', 'â³');
    
    // ç­‰å¾…Chart.jsåŠ è½½å®Œæˆåå†æ¸²æŸ“
    waitForChartJS().then(() => {
      console.log('Chart.jsåŠ è½½å®Œæˆï¼Œç»§ç»­æ¸²æŸ“å›¾è¡¨');
      renderPlatformChart(platform);
    }).catch(error => {
      console.error('Chart.jsåŠ è½½å¤±è´¥:', error);
      updateStatus('Chart.jsåŠ è½½å¤±è´¥', 'âŒ');
    });
    return;
  }
  
  // æ£€æŸ¥Canvaså…ƒç´ æ˜¯å¦å­˜åœ¨
  const canvas = document.getElementById('platformChart');
  if (!canvas) {
    console.error('æ‰¾ä¸åˆ°platformChartå…ƒç´ ');
    updateStatus('æ‰¾ä¸åˆ°å¹³å°å›¾è¡¨å®¹å™¨', 'âŒ');
    return;
  }
     
  // æ£€æŸ¥Canvaså®¹å™¨æ˜¯å¦å¯è§
  const container = document.getElementById('platformChartContainer');
  if (container && container.classList.contains('hidden')) {
    console.log('å®¹å™¨ä¸å¯è§ï¼Œç­‰å¾…æ˜¾ç¤ºåå†æ¸²æŸ“');
    return;
  }
         
         // æ¨¡æ‹Ÿæ•°æ® - è¿‡å»15å¤©
         const dates = ['12-01', '12-02', '12-03', '12-04', '12-05', '12-06', '12-07', '12-08', '12-09', '12-10', '12-11', '12-12', '12-13', '12-14', '12-15'];
         let chartData;
         let platformName;
         
         // æ ¹æ®å¹³å°è®¾ç½®ä¸åŒæ•°æ®
         switch(platform) {
           case 'meituan':
             platformName = 'ç¾å›¢';
             chartData = {
               // è‡ªç„¶GMVå’Œæ´»åŠ¨GMVæ•°æ®
               naturalGMV: [650000, 700000, 750000, 720000, 780000, 830000, 800000, 850000, 900000, 870000, 920000, 970000, 940000, 990000, 1040000],
               activityGMV: [240000, 250000, 270000, 260000, 270000, 290000, 280000, 300000, 320000, 310000, 330000, 350000, 340000, 360000, 380000],
               // ä¿ç•™è´¹æ¯”æ•°æ®
               totalFeeRatio: [12.5, 12.8, 13.2, 12.9, 13.5, 13.8, 13.4, 14.0, 14.3, 14.0, 14.5, 14.8, 14.5, 15.0, 15.3], // å…¨é‡è´¹æ¯”
               activityFeeRatio: [18.2, 18.5, 19.0, 18.7, 19.3, 19.6, 19.2, 19.8, 20.1, 19.8, 20.3, 20.6, 20.3, 20.8, 21.1] // æ´»åŠ¨è´¹æ¯”
             };
             // è®¡ç®—å…¨é‡GMV
             chartData.totalGMV = chartData.naturalGMV.map((val, idx) => val + chartData.activityGMV[idx]);
             break;
           case 'eleme':
             platformName = 'é¥¿äº†ä¹ˆ';
             chartData = {
               // è‡ªç„¶GMVå’Œæ´»åŠ¨GMVæ•°æ®
               naturalGMV: [480000, 500000, 530000, 510000, 550000, 580000, 560000, 600000, 630000, 610000, 650000, 680000, 660000, 700000, 730000],
               activityGMV: [170000, 180000, 190000, 190000, 200000, 210000, 210000, 220000, 230000, 230000, 240000, 250000, 250000, 260000, 270000],
               // ä¿ç•™è´¹æ¯”æ•°æ®
               totalFeeRatio: [11.8, 12.1, 12.5, 12.2, 12.8, 13.1, 12.8, 13.4, 13.7, 13.4, 13.9, 14.2, 13.9, 14.4, 14.7],
               activityFeeRatio: [17.5, 17.8, 18.2, 17.9, 18.5, 18.8, 18.5, 19.1, 19.4, 19.1, 19.6, 19.9, 19.6, 20.1, 20.4]
             };
             // è®¡ç®—å…¨é‡GMV
             chartData.totalGMV = chartData.naturalGMV.map((val, idx) => val + chartData.activityGMV[idx]);
             break;
           case 'jd':
             platformName = 'äº¬ä¸œåˆ°å®¶';
             chartData = {
               // è‡ªç„¶GMVå’Œæ´»åŠ¨GMVæ•°æ®
               naturalGMV: [350000, 370000, 390000, 380000, 410000, 430000, 420000, 450000, 470000, 460000, 490000, 510000, 500000, 530000, 550000],
               activityGMV: [130000, 140000, 150000, 140000, 150000, 160000, 150000, 160000, 170000, 160000, 170000, 180000, 170000, 180000, 190000],
               // ä¿ç•™è´¹æ¯”æ•°æ®
               totalFeeRatio: [13.2, 13.5, 13.9, 13.6, 14.2, 14.5, 14.2, 14.8, 15.1, 14.8, 15.3, 15.6, 15.3, 15.8, 16.1],
               activityFeeRatio: [19.0, 19.3, 19.7, 19.4, 20.0, 20.3, 20.0, 20.6, 20.9, 20.6, 21.1, 21.4, 21.1, 21.6, 21.9]
             };
             // è®¡ç®—å…¨é‡GMV
             chartData.totalGMV = chartData.naturalGMV.map((val, idx) => val + chartData.activityGMV[idx]);
             break;
           default:
             console.error(`æœªçŸ¥å¹³å°: ${platform}`);
             return;
         }
       
         // é”€æ¯å·²æœ‰å›¾è¡¨
         if (window.platformChartInstance) {
           console.log('é”€æ¯å·²æœ‰å¹³å°å›¾è¡¨å®ä¾‹');
           window.platformChartInstance.destroy();
           window.platformChartInstance = null;
         }
       
         // åˆ›å»ºæ–°å›¾è¡¨
         const ctx = canvas.getContext('2d');
         if (!ctx) {
           console.error('æ— æ³•è·å–2Dä¸Šä¸‹æ–‡');
           return;
         }
         
         console.log(`åˆ›å»º${platformName}å›¾è¡¨ï¼Œæ•°æ®:`, chartData);
         
         try {
           window.platformChartInstance = new Chart(ctx, {
             type: 'bar',
             data: {
               labels: dates,
               datasets: [
                 // 1. å…¨é‡è´¹æ¯”æŠ˜çº¿å›¾ - ç»¿è‰²
                 {
                   label: 'å…¨é‡è´¹æ¯”',
                   data: chartData.totalFeeRatio,
                   type: 'line',
                   borderColor: '#4CAF50',
                   backgroundColor: 'transparent',
                   borderWidth: 3,
                   tension: 0.4,
                   yAxisID: 'y1',
                   order: 1,
                   pointRadius: 5,
                   pointHoverRadius: 7,
                   pointBackgroundColor: '#4CAF50',
                   pointBorderColor: '#ffffff',
                   pointBorderWidth: 2,
                   pointHoverBackgroundColor: '#4CAF50',
                   pointHoverBorderColor: '#ffffff',
                   pointHoverBorderWidth: 3
                 },
                 // 2. æ´»åŠ¨GMVæŸ±çŠ¶å›¾ - ç´«è‰²
                 {
                   label: 'æ´»åŠ¨GMV',
                   data: chartData.activityGMV,
                   backgroundColor: '#9C27B0',
                   borderColor: '#7B1FA2',
                   borderWidth: 1,
                   borderRadius: {
                     topLeft: 4,
                     topRight: 4,
                     bottomLeft: 0,
                     bottomRight: 0
                   },
                   borderSkipped: false,
                   yAxisID: 'y',
                   order: 2,
                   stack: 'GMV' // å †å æ ‡è¯†
                 },
                 // 3. æ´»åŠ¨è´¹æ¯”æŠ˜çº¿å›¾ - æ©™è‰²
                 {
                   label: 'æ´»åŠ¨è´¹æ¯”',
                   data: chartData.activityFeeRatio,
                   type: 'line',
                   borderColor: '#FF9800',
                   backgroundColor: 'transparent',
                   borderWidth: 3,
                   tension: 0.4,
                   yAxisID: 'y1',
                   order: 3,
                   pointRadius: 5,
                   pointHoverRadius: 7,
                   pointBackgroundColor: '#FF9800',
                   pointBorderColor: '#ffffff',
                   pointBorderWidth: 2,
                   pointHoverBackgroundColor: '#FF9800',
                   pointHoverBorderColor: '#ffffff',
                   pointHoverBorderWidth: 3
                 },
                 // 4. è‡ªç„¶GMVæŸ±çŠ¶å›¾ - è“è‰²
                 {
                   label: 'è‡ªç„¶GMV',
                   data: chartData.naturalGMV,
                   backgroundColor: '#2196F3',
                   borderColor: '#1976D2',
                   borderWidth: 1,
                   borderRadius: {
                     topLeft: 4,
                     topRight: 4,
                     bottomLeft: 0,
                     bottomRight: 0
                   },
                   borderSkipped: false,
                   yAxisID: 'y',
                   order: 4,
                   stack: 'GMV' // å †å æ ‡è¯†
                 }
               ]
             },
             options: {
               responsive: true,
               maintainAspectRatio: false,
               interaction: {
                 mode: 'index',
                 intersect: false,
               },
               layout: {
                 padding: {
                   top: 20,
                   bottom: 20,
                   left: 15,
                   right: 15
                 }
               },
               scales: {
                 y: {
                   type: 'linear',
                   display: true,
                   position: 'left',
                   stacked: true, // å¯ç”¨å †å 
                   title: {
                     display: true,
                     text: 'å…¨é‡GMV',
                     font: {
                       size: 14,
                       weight: 'bold'
                     },
                     color: '#374151'
                   },
                   ticks: {
                     callback: function(value) {
                       return value.toLocaleString();
                     },
                     font: {
                       size: 12
                     },
                     color: '#6b7280',
                     padding: 8
                   },
                   grid: {
                     color: 'rgba(156, 163, 175, 0.15)',
                     lineWidth: 1
                   },
                   beginAtZero: true
                 },
                 y1: {
                   type: 'linear',
                   display: true,
                   position: 'right',
                   title: {
                     display: true,
                     text: 'è´¹æ¯”(%)',
                     font: {
                       size: 14,
                       weight: 'bold'
                     },
                     color: '#374151'
                   },
                   grid: {
                     drawOnChartArea: false,
                   },
                   ticks: {
                     callback: function(value) {
                       return value + '%';
                     },
                     font: {
                       size: 12
                     },
                     color: '#6b7280',
                     padding: 8
                   },
                   min: 0,
                   max: 25
                 },
                 x: {
                   title: {
                     display: false
                   },
                   ticks: {
                     font: {
                       size: 12,
                       weight: '500'
                     },
                     color: '#374151',
                     maxRotation: 0,
                     padding: 8
                   },
                   grid: {
                     display: false
                   }
                 }
               },
               plugins: {
                 title: {
                   display: true,
                   text: platformName + 'æ•°æ®è¶‹åŠ¿åˆ†æ',
                   font: {
                     size: 18,
                     weight: 'bold'
                   },
                   color: '#1f2937',
                   padding: {
                     top: 10,
                     bottom: 20
                   }
                 },
                 legend: {
                   position: 'bottom',
                   align: 'center',
                   labels: {
                     usePointStyle: true,
                     pointStyle: function(context) {
                       // æ ¹æ®æ•°æ®é›†ç´¢å¼•è®¾ç½®ç‚¹æ ·å¼
                       if (context.datasetIndex === 0 || context.datasetIndex === 2) {
                         return 'circle'; // è´¹æ¯”ç±»ï¼ˆæŠ˜çº¿ï¼‰
                       } else {
                         return 'rect'; // GMVç±»ï¼ˆæŸ±çŠ¶ï¼‰
                       }
                     },
                     font: {
                       size: 13,
                       weight: '500'
                     },
                     color: '#374151',
                     padding: 20,
                     boxWidth: 15,
                     boxHeight: 15
                   }
                 },
                 tooltip: {
                   backgroundColor: 'rgba(17, 24, 39, 0.95)',
                   titleColor: '#ffffff',
                   bodyColor: '#ffffff',
                   borderColor: 'rgba(156, 163, 175, 0.3)',
                   borderWidth: 1,
                   cornerRadius: 8,
                   padding: 12,
                   titleFont: {
                     size: 14,
                     weight: 'bold'
                   },
                   bodyFont: {
                     size: 13
                   },
                   callbacks: {
                     title: function(context) {
                       return platformName + ' - ' + context[0].label;
                     },
                     label: function(context) {
                       let label = context.dataset.label || '';
                       if (label) {
                         label += ': ';
                       }
                       if (label.includes('GMV')) {
                         // GMVæ•°æ®
                         label += context.raw.toLocaleString();
                       } else {
                         // è´¹æ¯”æ•°æ®
                         label += context.raw + '%';
                       }
                       return label;
                     },
                     afterLabel: function(context) {
                       // åœ¨æ‰€æœ‰æ•°æ®ç‚¹ä¸Šéƒ½æ˜¾ç¤ºå…¨é‡GMVä¿¡æ¯
                       const index = context.dataIndex;
                       const totalGMV = chartData.totalGMV[index];
                       return 'å…¨é‡GMV: ' + totalGMV.toLocaleString();
                     }
                   }
                 }
               },
               elements: {
                 point: {
                   hoverRadius: 8
                 },
                 line: {
                   borderJoinStyle: 'round'
                 }
               },
               animation: {
                 duration: 1200,
                 easing: 'easeInOutQuart'
               }
             }
           });
           
           console.log(`${platformName}å›¾è¡¨åˆ›å»ºæˆåŠŸ`);
         } catch (error) {
           console.error(`åˆ›å»º${platformName}å›¾è¡¨å¤±è´¥:`, error);
         }
       }
       
       // æ¸²æŸ“æ ¸é”€è´¹ç”¨è¶‹åŠ¿å›¾
       function renderExpenseChart() {
         console.log('å¼€å§‹æ¸²æŸ“å…¨å¹³å°æ ¸é”€è´¹ç”¨è¶‹åŠ¿å›¾');
         
         // æ£€æŸ¥Canvaså…ƒç´ æ˜¯å¦å­˜åœ¨
         const canvas = document.getElementById('expenseChart');
         if (!canvas) {
           console.error('æ‰¾ä¸åˆ°expenseChartå…ƒç´ ');
           return;
         }
         
         // æ£€æŸ¥Canvaså®¹å™¨æ˜¯å¦å¯è§
         const container = document.getElementById('expenseChartContainer');
         if (container && container.classList.contains('hidden')) {
           console.log('å®¹å™¨ä¸å¯è§ï¼Œç­‰å¾…æ˜¾ç¤ºåå†æ¸²æŸ“');
           return;
         }
         
         // æ¨¡æ‹Ÿæ•°æ® - è¿‡å»15å¤©å„å¹³å°æ ¸é”€è´¹ç”¨
         const dates = ['12-01', '12-02', '12-03', '12-04', '12-05', '12-06', '12-07', '12-08', '12-09', '12-10', '12-11', '12-12', '12-13', '12-14', '12-15'];
         const platformData = {
           meituan: {
             name: 'ç¾å›¢',
             color: '#FFD161',
             verificationFee: [125000, 148000, 172000, 158000, 185000, 210000, 195000, 225000, 248000, 235000, 265000, 290000, 275000, 305000, 335000]
           },
           eleme: {
             name: 'é¥¿äº†ä¹ˆ',
             color: '#0086FF', 
             verificationFee: [98000, 112000, 125000, 118000, 135000, 152000, 145000, 165000, 182000, 175000, 195000, 215000, 205000, 225000, 245000]
           },
           jd: {
             name: 'äº¬ä¸œåˆ°å®¶',
             color: '#01af00',
             verificationFee: [78000, 88000, 98000, 92000, 105000, 118000, 112000, 128000, 142000, 135000, 152000, 168000, 160000, 178000, 195000]
           }
         };

         // é”€æ¯å·²æœ‰å›¾è¡¨
         if (window.expenseChartInstance) {
           console.log('é”€æ¯å·²æœ‰å…¨å¹³å°å›¾è¡¨å®ä¾‹');
           window.expenseChartInstance.destroy();
           window.expenseChartInstance = null;
         }

         // åˆ›å»ºæ–°å›¾è¡¨
         const ctx = canvas.getContext('2d');
         if (!ctx) {
           console.error('æ— æ³•è·å–2Dä¸Šä¸‹æ–‡');
           return;
         }

         // å‡†å¤‡æ•°æ®é›†
         const datasets = Object.values(platformData).map(platform => ({
           label: platform.name,
           data: platform.verificationFee,
           borderColor: platform.color,
           backgroundColor: platform.color + '20', // åŠé€æ˜å¡«å……
           borderWidth: 3,
           tension: 0.4,
           fill: true,
           pointRadius: 5,
           pointHoverRadius: 7,
           pointBackgroundColor: platform.color,
           pointHoverBackgroundColor: '#ffffff',
           pointBorderColor: '#ffffff',
           pointHoverBorderColor: platform.color,
           pointBorderWidth: 2,
           pointHoverBorderWidth: 3
         }));
         
         console.log('å‡†å¤‡æ•°æ®é›†:', datasets);

         try {
           window.expenseChartInstance = new Chart(ctx, {
             type: 'line',
             data: {
               labels: dates,
               datasets: datasets
             },
             options: {
               responsive: true,
               maintainAspectRatio: false,
               interaction: {
                 mode: 'index',
                 intersect: false,
               },
               layout: {
                 padding: {
                   top: 20,
                   bottom: 20,
                   left: 15,
                   right: 15
                 }
               },
               scales: {
                 y: {
                   type: 'linear',
                   display: true,
                   position: 'left',
                   title: {
                     display: true,
                     text: 'æ ¸é”€è´¹ç”¨',
                     font: {
                       size: 14,
                       weight: 'bold'
                     },
                     color: '#374151'
                   },
                   ticks: {
                     callback: function(value) {
                       return value.toLocaleString();
                     },
                     font: {
                       size: 12
                     },
                     color: '#6b7280',
                     padding: 8
                   },
                   grid: {
                     color: 'rgba(156, 163, 175, 0.15)',
                     lineWidth: 1
                   },
                   beginAtZero: true
                 },
                 x: {
                   title: {
                     display: false
                   },
                   ticks: {
                     font: {
                       size: 12,
                       weight: '500'
                     },
                     color: '#374151',
                     maxRotation: 0,
                     padding: 8
                   },
                   grid: {
                     display: false
                   }
                 }
               },
               plugins: {
                 title: {
                   display: true,
                   text: 'å„å¹³å°æ ¸é”€è´¹ç”¨è¶‹åŠ¿å¯¹æ¯”',
                   font: {
                     size: 18,
                     weight: 'bold'
                   },
                   color: '#1f2937',
                   padding: {
                     top: 10,
                     bottom: 20
                   }
                 },
                 legend: {
                   position: 'bottom',
                   align: 'center',
                   labels: {
                     usePointStyle: true,
                     pointStyle: 'circle',
                     font: {
                       size: 13,
                       weight: '500'
                     },
                     color: '#374151',
                     padding: 20,
                     boxWidth: 15,
                     boxHeight: 15
                   }
                 },
                 tooltip: {
                   backgroundColor: 'rgba(17, 24, 39, 0.95)',
                   titleColor: '#ffffff',
                   bodyColor: '#ffffff',
                   borderColor: 'rgba(156, 163, 175, 0.3)',
                   borderWidth: 1,
                   cornerRadius: 8,
                   padding: 12,
                   titleFont: {
                     size: 14,
                     weight: 'bold'
                   },
                   bodyFont: {
                     size: 13
                   },
                   callbacks: {
                     title: function(context) {
                       return 'æ ¸é”€è´¹ç”¨ - ' + context[0].label;
                     },
                     label: function(context) {
                       let label = context.dataset.label || '';
                       if (label) {
                         label += ': ';
                       }
                       label += context.raw.toLocaleString();
                       return label;
                     }
                   }
                 }
               },
               elements: {
                 point: {
                   hoverRadius: 8
                 },
                 line: {
                   borderJoinStyle: 'round'
                 }
               },
               animation: {
                 duration: 1200,
                 easing: 'easeInOutQuart'
               }
             }
           });
           
           console.log('å…¨å¹³å°æ ¸é”€è´¹ç”¨è¶‹åŠ¿å›¾åˆ›å»ºæˆåŠŸ');
         } catch (error) {
           console.error('åˆ›å»ºå…¨å¹³å°å›¾è¡¨å¤±è´¥:', error);
         }
       }
     </script>

<script>
    // çŠ¶æ€æ›´æ–°å‡½æ•°
    function updateStatus(message, icon) {
      const statusText = document.getElementById('statusText');
      const statusIcon = document.getElementById('statusIcon');
      
      if (statusText) {
        statusText.textContent = message;
      }
      if (statusIcon) {
        statusIcon.textContent = icon;
      }
      
      console.log('çŠ¶æ€æ›´æ–°:', icon, message);
    }
    
    // æ—¥æœŸç­›é€‰å™¨åŠŸèƒ½
    function initializeDateFilter() {
      const now = new Date();
      const currentYear = now.getFullYear();
      const currentMonth = now.getMonth(); // æ³¨æ„ï¼šgetMonth()è¿”å›0-11ï¼Œæ‰€ä»¥8æœˆæ˜¯7
      
      // è®¡ç®—å½“æœˆç¬¬ä¸€å¤©ï¼ˆå½“æœˆ1å·ï¼‰
      const firstDayOfMonth = new Date(currentYear, currentMonth, 1);
      
      // è®¡ç®—å½“æœˆT-1æ—¥ï¼ˆä»Šå¤©å‡å»1å¤©ï¼Œå³æ˜¨å¤©ï¼‰
      const today = new Date();
      const yesterday = new Date(today);
      yesterday.setDate(today.getDate() - 1);
      
      // å¦‚æœæ˜¨å¤©ä¸åœ¨å½“æœˆï¼Œåˆ™ä½¿ç”¨å½“æœˆæœ€åä¸€å¤©
      let endDate = yesterday;
      if (yesterday.getMonth() !== currentMonth || yesterday.getFullYear() !== currentYear) {
        // æ˜¨å¤©ä¸åœ¨å½“æœˆï¼Œä½¿ç”¨å½“æœˆæœ€åä¸€å¤©
        endDate = new Date(currentYear, currentMonth + 1, 0);
      }
      
      // æ ¼å¼åŒ–ä¸º YYYY-MM-DDï¼ˆä½¿ç”¨æœ¬åœ°æ—¥æœŸé¿å…æ—¶åŒºé—®é¢˜ï¼‰
      const formatDate = (date) => {
        const year = date.getFullYear();
        const month = String(date.getMonth() + 1).padStart(2, '0');
        const day = String(date.getDate()).padStart(2, '0');
        return `${year}-${month}-${day}`;
      };
      
      // è®¾ç½®é»˜è®¤æ—¥æœŸ
      const startDateInput = document.getElementById('startDate');
      const endDateInput = document.getElementById('endDate');
      
      if (startDateInput && endDateInput) {
        const formattedStartDate = formatDate(firstDayOfMonth);
        const formattedEndDate = formatDate(endDate);
        
        startDateInput.value = formattedStartDate;
        endDateInput.value = formattedEndDate;
        
        console.log('é»˜è®¤æ—¥æœŸè®¾ç½®:', {
          å¼€å§‹æ—¥æœŸ: formattedStartDate,
          ç»“æŸæ—¥æœŸ: formattedEndDate,
          å½“å‰æœˆä»½: currentMonth + 1, // æ˜¾ç¤ºæ—¶+1ï¼Œå› ä¸ºgetMonth()è¿”å›0-11
          ä»Šå¤©: formatDate(today),
          æ˜¨å¤©: formatDate(yesterday),
          ç¬¬ä¸€å¤©è®¡ç®—: `${currentYear}-${String(currentMonth + 1).padStart(2, '0')}-01`
        });
        
        // æ›´æ–°æ˜¾ç¤º
        updateDateRangeDisplay();
        
        // ç»‘å®šäº‹ä»¶
        const applyButton = document.getElementById('applyDateFilter');
        const resetButton = document.getElementById('resetDateFilter');
        
        if (applyButton) {
          applyButton.addEventListener('click', handleDateFilterApply);
        }
        
        if (resetButton) {
          resetButton.addEventListener('click', handleDateFilterReset);
        }
        
        // ç›‘å¬æ—¥æœŸè¾“å…¥æ¡†å˜åŒ–
        startDateInput.addEventListener('change', updateDateRangeDisplay);
        endDateInput.addEventListener('change', updateDateRangeDisplay);
      }
    }
    
    // æ›´æ–°æ—¥æœŸèŒƒå›´æ˜¾ç¤º
    function updateDateRangeDisplay() {
      const startDate = document.getElementById('startDate').value;
      const endDate = document.getElementById('endDate').value;
      const displayElement = document.getElementById('dateRangeDisplay');
      
      if (displayElement && startDate && endDate) {
        displayElement.textContent = `å½“å‰é€‰æ‹©ï¼š${startDate} è‡³ ${endDate}`;
      }
    }
    
    // åº”ç”¨æ—¥æœŸç­›é€‰
    function handleDateFilterApply() {
      const startDate = document.getElementById('startDate').value;
      const endDate = document.getElementById('endDate').value;
      
      if (!startDate || !endDate) {
        alert('è¯·é€‰æ‹©å¼€å§‹æ—¥æœŸå’Œç»“æŸæ—¥æœŸ');
        return;
      }
      
      if (new Date(startDate) > new Date(endDate)) {
        alert('å¼€å§‹æ—¥æœŸä¸èƒ½å¤§äºç»“æŸæ—¥æœŸ');
        return;
      }
      
      console.log('åº”ç”¨æ—¥æœŸç­›é€‰:', startDate, 'è‡³', endDate);
      
      // è¿™é‡Œå¯ä»¥æ·»åŠ é‡æ–°åŠ è½½å›¾è¡¨æ•°æ®çš„é€»è¾‘
      updateChartsWithDateRange(startDate, endDate);
      
      // æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯
      updateStatus('æ—¥æœŸç­›é€‰å·²åº”ç”¨', 'âœ“');
      setTimeout(() => {
        const statusDiv = document.getElementById('chartStatus');
        if (statusDiv) {
          statusDiv.style.display = 'none';
        }
      }, 2000);
    }
    
    // é‡ç½®æ—¥æœŸç­›é€‰
    function handleDateFilterReset() {
      initializeDateFilter();
      console.log('æ—¥æœŸç­›é€‰å·²é‡ç½®');
      
      // é‡æ–°åŠ è½½é»˜è®¤æ•°æ®
      const startDate = document.getElementById('startDate').value;
      const endDate = document.getElementById('endDate').value;
      updateChartsWithDateRange(startDate, endDate);
      
      updateStatus('æ—¥æœŸç­›é€‰å·²é‡ç½®', 'âœ“');
      setTimeout(() => {
        const statusDiv = document.getElementById('chartStatus');
        if (statusDiv) {
          statusDiv.style.display = 'none';
        }
      }, 2000);
    }
    
    // æ ¹æ®æ—¥æœŸèŒƒå›´æ›´æ–°å›¾è¡¨æ•°æ®
    function updateChartsWithDateRange(startDate, endDate) {
      console.log('æ›´æ–°å›¾è¡¨æ•°æ®èŒƒå›´:', startDate, '-', endDate);
      
      // è®¡ç®—æ—¥æœŸèŒƒå›´å†…çš„å¤©æ•°
      const start = new Date(startDate);
      const end = new Date(endDate);
      const daysDiff = Math.ceil((end - start) / (1000 * 60 * 60 * 24)) + 1;
      
      console.log(`æ—¥æœŸèŒƒå›´å…±${daysDiff}å¤©`);
      
      // é‡æ–°æ¸²æŸ“æ‰€æœ‰å›¾è¡¨
      if (typeof renderExpenseChart === 'function') {
        renderExpenseChart();
      }
      
      // é‡æ–°æ¸²æŸ“å½“å‰æ¿€æ´»çš„å¹³å°å›¾è¡¨
      const activeTab = document.querySelector('.platform-tab.active');
      if (activeTab) {
        const platform = activeTab.id.replace('tab-', '');
        if (platform !== 'all' && typeof renderPlatformChart === 'function') {
          renderPlatformChart(platform);
        }
      }
    }
    
    // åŠ è½½å¹³å°è¡¨æ ¼æ•°æ®
    function loadPlatformTableData(platform) {
      console.log(`åŠ è½½${platform}å¹³å°è¡¨æ ¼æ•°æ®`);
      
      // æ¨¡æ‹Ÿæ•°æ®
      const mockData = generateMockTableData(platform);
      
      // å¡«å……ç¬¬ä¸€ä¸ªè¡¨æ ¼ï¼ˆæ´»åŠ¨æ–¹æ¡ˆæ•°æ®ï¼‰
      populateActivityPlanTable(mockData.activityPlan);
      
      // å¡«å……ç¬¬äºŒä¸ªè¡¨æ ¼ï¼ˆæ´»åŠ¨æ•ˆæœæ•°æ®ï¼‰
      populateActivityEffectTable(mockData.activityEffect);
    }
    
    // ç”Ÿæˆæ¨¡æ‹Ÿè¡¨æ ¼æ•°æ®
    function generateMockTableData(platform) {
      const platformNames = {
        'meituan': 'ç¾å›¢',
        'eleme': 'é¥¿äº†ä¹ˆ',
        'jd': 'äº¬ä¸œåˆ°å®¶'
      };
      
      const platformName = platformNames[platform] || platform;
      
      // æ´»åŠ¨æ•ˆæœæ•°æ®ï¼ˆç¬¬ä¸€ä¸ªè¡¨æ ¼ï¼‰
      const activityEffect = [
        {
          planName: `${platformName}æ‹‰æ–°æ´»åŠ¨`,
          activityType: 'æ‹‰æ–°',
          mechanismType: 'æ»¡å‡åˆ¸',
          mechanism: 'æ»¡200å‡50',
          discountRate: '25%',
          threshold: '200å…ƒ',
          faceValue: '50å…ƒ',
          dailyAmount: '25,680',
          dailyGMV: '156,800',
          activityFeeRatio: '16.4%',
          mtdAmount: '385,200',
          mtdGMV: '2,341,600',
          mtdFeeRatio: '16.5%'
        },
        {
          planName: `${platformName}ä¿ƒé”€æ–¹æ¡ˆ`,
          activityType: 'ä¿ƒé”€',
          mechanismType: 'æŠ˜æ‰£åˆ¸',
          mechanism: '8.5æŠ˜åˆ¸',
          discountRate: '15%',
          threshold: '150å…ƒ',
          faceValue: '22.5å…ƒ',
          dailyAmount: '18,450',
          dailyGMV: '122,900',
          activityFeeRatio: '15.0%',
          mtdAmount: '276,750',
          mtdGMV: '1,843,500',
          mtdFeeRatio: '15.0%'
        },
        {
          planName: `${platformName}ä¼šå‘˜ä¸“äº«`,
          activityType: 'ä¼šå‘˜',
          mechanismType: 'ä¸“äº«åˆ¸',
          mechanism: 'æ»¡100å‡30',
          discountRate: '30%',
          threshold: '100å…ƒ',
          faceValue: '30å…ƒ',
          dailyAmount: '12,300',
          dailyGMV: '86,100',
          activityFeeRatio: '14.3%',
          mtdAmount: '184,500',
          mtdGMV: '1,291,500',
          mtdFeeRatio: '14.3%'
        },
        {
          planName: `${platformName}å¤æ—¥ç‰¹æƒ `,
          activityType: 'å­£èŠ‚æ€§',
          mechanismType: 'æ»¡å‡åˆ¸',
          mechanism: 'æ»¡300å‡80',
          discountRate: '26.7%',
          threshold: '300å…ƒ',
          faceValue: '80å…ƒ',
          dailyAmount: '32,400',
          dailyGMV: '162,000',
          activityFeeRatio: '20.0%',
          mtdAmount: '486,000',
          mtdGMV: '2,430,000',
          mtdFeeRatio: '20.0%'
        },
        {
          planName: `${platformName}é™æ—¶æŠ¢è´­`,
          activityType: 'é™æ—¶',
          mechanismType: 'ç§’æ€åˆ¸',
          mechanism: 'æ»¡500å‡150',
          discountRate: '30%',
          threshold: '500å…ƒ',
          faceValue: '150å…ƒ',
          dailyAmount: '45,600',
          dailyGMV: '228,000',
          activityFeeRatio: '20.0%',
          mtdAmount: '684,000',
          mtdGMV: '3,420,000',
          mtdFeeRatio: '20.0%'
        },
        {
          planName: `${platformName}ç”Ÿé²œä¸“åŒº`,
          activityType: 'å“ç±»',
          mechanismType: 'å“ç±»åˆ¸',
          mechanism: 'æ»¡80å‡15',
          discountRate: '18.8%',
          threshold: '80å…ƒ',
          faceValue: '15å…ƒ',
          dailyAmount: '15,750',
          dailyGMV: '84,000',
          activityFeeRatio: '18.8%',
          mtdAmount: '236,250',
          mtdGMV: '1,260,000',
          mtdFeeRatio: '18.8%'
        }
      ];
      
      // æ´»åŠ¨æ–¹æ¡ˆæ•°æ®ï¼ˆç¬¬äºŒä¸ªè¡¨æ ¼ï¼‰
      const activityPlan = [
        {
          activityType: 'æ‹‰æ–°',
          planName: `${platformName}æ–°ç”¨æˆ·ç¤¼åŒ…`,
          activityName: 'æ–°äººä¸“äº«å¤§ç¤¼åŒ…',
          mechanismName: 'æ–°äººåˆ¸åŒ…',
          mechanismType: 'åˆ¸åŒ…',
          couponStrength: 'æ»¡200å‡80',
          threshold: '200å…ƒ',
          faceValue: '80å…ƒ',
          activityTime: '2024-08-01 è‡³ 2024-08-31',
          budgetAmount: '500,000',
          mtdAmount: '342,150',
          mtdProgress: '68.4%',
          timeProgress: '80.6%',
          remainingBudget: '157,850'
        },
        {
          activityType: 'ä¿ƒé”€',
          planName: `${platformName}å‘¨æœ«ç‹‚æ¬¢`,
          activityName: 'å‘¨æœ«è´­ç‰©èŠ‚',
          mechanismName: 'å‘¨æœ«åˆ¸',
          mechanismType: 'æ—¶æ®µåˆ¸',
          couponStrength: 'æ»¡150å‡40',
          threshold: '150å…ƒ',
          faceValue: '40å…ƒ',
          activityTime: '2024-08-03 è‡³ 2024-08-31',
          budgetAmount: '300,000',
          mtdAmount: '185,600',
          mtdProgress: '61.9%',
          timeProgress: '75.9%',
          remainingBudget: '114,400'
        },
        {
          activityType: 'ä¼šå‘˜',
          planName: `${platformName}VIPç‰¹æƒ`,
          activityName: 'VIPä¼šå‘˜ä¸“äº«æ—¥',
          mechanismName: 'VIPä¸“äº«åˆ¸',
          mechanismType: 'ä¼šå‘˜åˆ¸',
          couponStrength: 'æ»¡100å‡35',
          threshold: '100å…ƒ',
          faceValue: '35å…ƒ',
          activityTime: '2024-08-01 è‡³ 2024-08-31',
          budgetAmount: '200,000',
          mtdAmount: '124,800',
          mtdProgress: '62.4%',
          timeProgress: '80.6%',
          remainingBudget: '75,200'
        },
        {
          activityType: 'å­£èŠ‚æ€§',
          planName: `${platformName}å¤æ—¥æ¸…å‡‰`,
          activityName: 'å¤æ—¥æ¶ˆæš‘ç‰¹æƒ ',
          mechanismName: 'å¤æ—¥åˆ¸',
          mechanismType: 'å­£èŠ‚åˆ¸',
          couponStrength: 'æ»¡250å‡70',
          threshold: '250å…ƒ',
          faceValue: '70å…ƒ',
          activityTime: '2024-08-01 è‡³ 2024-08-31',
          budgetAmount: '600,000',
          mtdAmount: '456,300',
          mtdProgress: '76.1%',
          timeProgress: '80.6%',
          remainingBudget: '143,700'
        },
        {
          activityType: 'é™æ—¶',
          planName: `${platformName}é—ªè´­ç‹‚æ¬¢`,
          activityName: 'é™æ—¶é—ªè´­æ´»åŠ¨',
          mechanismName: 'é—ªè´­åˆ¸',
          mechanismType: 'é™æ—¶åˆ¸',
          couponStrength: 'æ»¡400å‡120',
          threshold: '400å…ƒ',
          faceValue: '120å…ƒ',
          activityTime: '2024-08-15 è‡³ 2024-08-31',
          budgetAmount: '800,000',
          mtdAmount: '298,400',
          mtdProgress: '37.3%',
          timeProgress: '45.2%',
          remainingBudget: '501,600'
        },
        {
          activityType: 'å“ç±»',
          planName: `${platformName}ç”Ÿé²œç‰¹å–`,
          activityName: 'ç”Ÿé²œå“ç±»ä¿ƒé”€',
          mechanismName: 'ç”Ÿé²œåˆ¸',
          mechanismType: 'å“ç±»åˆ¸',
          couponStrength: 'æ»¡120å‡25',
          threshold: '120å…ƒ',
          faceValue: '25å…ƒ',
          activityTime: '2024-08-01 è‡³ 2024-08-31',
          budgetAmount: '350,000',
          mtdAmount: '231,700',
          mtdProgress: '66.2%',
          timeProgress: '80.6%',
          remainingBudget: '118,300'
        }
      ];
      
      return {
        activityEffect,
        activityPlan
      };
    }
    
    // å¡«å……æ´»åŠ¨æ•ˆæœæ•°æ®è¡¨ï¼ˆç¬¬ä¸€ä¸ªè¡¨æ ¼ï¼‰
    function populateActivityEffectTable(data) {
      const tableBody = document.getElementById('activityEffectTableBody');
      if (!tableBody) {
        console.error('æ‰¾ä¸åˆ°activityEffectTableBodyå…ƒç´ ');
        return;
      }
      
      tableBody.innerHTML = '';
      
      data.forEach((item, index) => {
        const row = document.createElement('tr');
        row.className = 'hover:bg-gray-50 transition-colors';
        
        row.innerHTML = `
          <td class="px-4 py-3 text-sm text-gray-900 font-medium">${item.planName}</td>
          <td class="px-4 py-3 text-sm text-gray-600">${item.activityType}</td>
          <td class="px-4 py-3 text-sm text-gray-600">${item.mechanismType}</td>
          <td class="px-4 py-3 text-sm text-gray-600">${item.mechanism}</td>
          <td class="px-4 py-3 text-sm text-gray-600">${item.discountRate}</td>
          <td class="px-4 py-3 text-sm text-gray-600">${item.threshold}</td>
          <td class="px-4 py-3 text-sm text-gray-600">${item.faceValue}</td>
          <td class="px-4 py-3 text-sm text-gray-900 font-medium">${item.dailyAmount}</td>
          <td class="px-4 py-3 text-sm text-gray-900 font-medium">${item.dailyGMV}</td>
          <td class="px-4 py-3 text-sm font-medium ${parseFloat(item.activityFeeRatio) > 18 ? 'text-red-600' : 'text-green-600'}">${item.activityFeeRatio}</td>
          <td class="px-4 py-3 text-sm text-gray-900 font-medium">${item.mtdAmount}</td>
          <td class="px-4 py-3 text-sm text-gray-900 font-medium">${item.mtdGMV}</td>
          <td class="px-4 py-3 text-sm font-medium ${parseFloat(item.mtdFeeRatio) > 18 ? 'text-red-600' : 'text-green-600'}">${item.mtdFeeRatio}</td>
        `;
        
        tableBody.appendChild(row);
      });
      
      console.log(`æ´»åŠ¨æ•ˆæœæ•°æ®è¡¨å·²å¡«å…… ${data.length} æ¡è®°å½•`);
    }
    
    // å¡«å……æ´»åŠ¨æ–¹æ¡ˆæ•°æ®è¡¨ï¼ˆç¬¬äºŒä¸ªè¡¨æ ¼ï¼‰
    function populateActivityPlanTable(data) {
      const tableBody = document.getElementById('activityPlanTableBody');
      if (!tableBody) {
        console.error('æ‰¾ä¸åˆ°activityPlanTableBodyå…ƒç´ ');
        return;
      }
      
      tableBody.innerHTML = '';
      
      data.forEach((item, index) => {
        const row = document.createElement('tr');
        row.className = 'hover:bg-gray-50 transition-colors';
        
        const progressValue = parseFloat(item.mtdProgress);
        const timeProgressValue = parseFloat(item.timeProgress);
        
        // åˆ¤æ–­è¿›åº¦çŠ¶æ€é¢œè‰²
        let progressColor = 'text-green-600';
        if (progressValue > timeProgressValue + 10) {
          progressColor = 'text-red-600'; // è¶…æ”¯é£é™©
        } else if (progressValue < timeProgressValue - 10) {
          progressColor = 'text-orange-600'; // æ¶ˆè€—ä¸è¶³
        }
        
        row.innerHTML = `
          <td class="px-4 py-3 text-sm text-gray-600">${item.activityType}</td>
          <td class="px-4 py-3 text-sm text-gray-900 font-medium">${item.planName}</td>
          <td class="px-4 py-3 text-sm text-gray-600">${item.activityName}</td>
          <td class="px-4 py-3 text-sm text-gray-600">${item.mechanismName}</td>
          <td class="px-4 py-3 text-sm text-gray-600">${item.mechanismType}</td>
          <td class="px-4 py-3 text-sm text-gray-600">${item.couponStrength}</td>
          <td class="px-4 py-3 text-sm text-gray-600">${item.threshold}</td>
          <td class="px-4 py-3 text-sm text-gray-600">${item.faceValue}</td>
          <td class="px-4 py-3 text-sm text-gray-600">${item.activityTime}</td>
          <td class="px-4 py-3 text-sm text-gray-900 font-medium">${item.budgetAmount}</td>
          <td class="px-4 py-3 text-sm text-gray-900 font-medium">${item.mtdAmount}</td>
          <td class="px-4 py-3 text-sm font-medium ${progressColor}">${item.mtdProgress}</td>
          <td class="px-4 py-3 text-sm text-gray-600">${item.timeProgress}</td>
          <td class="px-4 py-3 text-sm text-gray-900 font-medium">${item.remainingBudget}</td>
        `;
        
        tableBody.appendChild(row);
      });
      
      console.log(`æ´»åŠ¨æ–¹æ¡ˆæ•°æ®è¡¨å·²å¡«å…… ${data.length} æ¡è®°å½•`);
    }
</script>

<script>
    // çŠ¶æ€æ›´æ–°å‡½æ•°
    function updateStatus(message, icon) {
      const statusText = document.getElementById('statusText');
      const statusIcon = document.getElementById('statusIcon');
      
      if (statusText) {
        statusText.textContent = message;
      }
      if (statusIcon) {
        statusIcon.textContent = icon;
      }
      
      console.log('çŠ¶æ€æ›´æ–°:', icon, message);
    }
</script>

</body>
</html>
         
</script>

</body>
</html>
